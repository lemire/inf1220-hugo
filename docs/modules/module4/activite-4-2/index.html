<!doctype html><html lang=fr dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  Les flux de données: lecture dans des fichiers et autres
  #

Nous avons couvert la façon d'afficher des données à l'écran et de lire des données à partir du clavier en utilisant les flux de données (streams) dans les leçons précédentes. Quand nous avons utilisé les méthodes System.out.print ou System.out.println pour afficher des données à l'écran, ces dernières ont été envoyées sur un flux de sortie (output stream). Nous nous servirons des flux d'entrée et de sortie pour lire et écrire des données dans un fichier texte. Mais auparavant, il nous faut savoir comment créer le fichier dans lequel ces données seront archivées."><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://lemire.github.io/inf1220-hugo/docs/modules/module4/activite-4-2/"><meta property="og:site_name" content="INF 1220 - Introduction à la programmation"><meta property="og:title" content="Les flux de données: lecture dans des fichiers et autres"><meta property="og:description" content="Les flux de données: lecture dans des fichiers et autres # Nous avons couvert la façon d'afficher des données à l'écran et de lire des données à partir du clavier en utilisant les flux de données (streams) dans les leçons précédentes. Quand nous avons utilisé les méthodes System.out.print ou System.out.println pour afficher des données à l'écran, ces dernières ont été envoyées sur un flux de sortie (output stream). Nous nous servirons des flux d'entrée et de sortie pour lire et écrire des données dans un fichier texte. Mais auparavant, il nous faut savoir comment créer le fichier dans lequel ces données seront archivées."><meta property="og:locale" content="fr"><meta property="og:type" content="article"><meta property="article:section" content="docs"><title>Les flux de données: lecture dans des fichiers et autres | INF 1220 - Introduction à la programmation</title><link rel=icon href=/inf1220-hugo/favicon.png><link rel=manifest href=/inf1220-hugo/manifest.json><link rel=canonical href=https://lemire.github.io/inf1220-hugo/docs/modules/module4/activite-4-2/><link rel=stylesheet href=/inf1220-hugo/book.min.f5b6812da8cb28cdd091634583a6182b2e7f70231c885158fda89c58af6e3024.css integrity="sha256-9baBLajLKM3QkWNFg6YYKy5/cCMciFFY/aicWK9uMCQ=" crossorigin=anonymous><script defer src=/inf1220-hugo/fuse.min.js></script><script defer src=/inf1220-hugo/fr.search.min.fab04623d06311e6b62b5ba5fd9502f1de19fa3d09d53c14f83997aec7c78712.js integrity="sha256-+rBGI9BjEea2K1ul/ZUC8d4Z+j0J1TwU+DmXrsfHhxI=" crossorigin=anonymous></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js onload=renderMathInElement(document.body)></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/inf1220-hugo/><img src=/inf1220-hugo/livre.jpg alt=Logo class=book-icon><span>INF 1220 - Introduction à la programmation</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Rechercher aria-label=Rechercher maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li><a href=/inf1220-hugo/docs/environnement/>Programmation Java en ligne</a></li><li><a href=/inf1220-hugo/docs/erreurs/>Vous avez trouvé une erreur?</a></li><li><a href=/inf1220-hugo/docs/modules/>Modules</a><ul><li><input type=checkbox id=section-6ffbdc93c5edebe8ae6289c754c6323e class=toggle>
<label for=section-6ffbdc93c5edebe8ae6289c754c6323e class=flex><a href=/inf1220-hugo/docs/modules/module1/ class=flex-auto>Module 1: Algorithme et pseudocode</a></label><ul><li><a href=/inf1220-hugo/docs/modules/module1/teluq/>Modèle du cours</a></li><li><a href=/inf1220-hugo/docs/modules/module1/robot/>Robot conversationnel et intelligence artificielle</a></li><li><a href=/inf1220-hugo/docs/modules/module1/autoevaluation/>Autoévaluation</a></li><li><a href=/inf1220-hugo/docs/modules/module1/pasapas/>Java pas à pas</a></li><li><a href=/inf1220-hugo/docs/modules/module1/ordinateurs/>Les ordinateurs et leurs langages</a></li><li><a href=/inf1220-hugo/docs/modules/module1/algorithmes/>Les algorithmes</a></li><li><a href=/inf1220-hugo/docs/modules/module1/algorithmes2/>Les algorithmes : conception et syntaxe</a></li><li><a href=/inf1220-hugo/docs/modules/module1/algorithmes3/>Les algorithmes: les structures de contrôle</a></li><li><a href=/inf1220-hugo/docs/modules/module1/difficile/>Les problèmes difficiles</a></li><li><a href=/inf1220-hugo/docs/modules/module1/complex/>Complexité algorithmique</a></li><li><a href=/inf1220-hugo/docs/modules/module1/erreurs/>Les erreurs communes</a></li><li><a href=/inf1220-hugo/docs/modules/module1/exercices/>Exercices sur les algorithmes</a></li><li><a href=/inf1220-hugo/docs/modules/module1/travail-note-1/>Travail noté 1</a></li></ul></li><li><input type=checkbox id=section-71b9dfc90da9a83f173743029715be7a class=toggle>
<label for=section-71b9dfc90da9a83f173743029715be7a class=flex><a href=/inf1220-hugo/docs/modules/module2/ class=flex-auto>Module 2: Introduction au langage Java</a></label><ul><li><a href=/inf1220-hugo/docs/modules/module2/preparation/>Préparation de l’espace de travail</a></li><li><a href=/inf1220-hugo/docs/modules/module2/pasapas/>Java pas à pas</a></li><li><a href=/inf1220-hugo/docs/modules/module2/oriente/>Création d'une classe en Java</a></li><li><a href=/inf1220-hugo/docs/modules/module2/typeoperateur/>Introduction aux types de base et à leurs opérateurs</a></li><li><a href=/inf1220-hugo/docs/modules/module2/exercices-2-1/>Exercices sur les classes, les variables, les types et les opérateurs</a></li><li><a href=/inf1220-hugo/docs/modules/module2/methodes/>Méthodes et constructeurs</a></li><li><a href=/inf1220-hugo/docs/modules/module2/exercices-2-2/>Exercices sur les classes et méthodes</a></li><li><a href=/inf1220-hugo/docs/modules/module2/conseils/>Recommandations</a></li><li><a href=/inf1220-hugo/docs/modules/module2/travail-note-2/>Travail noté 2</a></li></ul></li><li><input type=checkbox id=section-67896e9afc9b4080d8c27b998062dd91 class=toggle>
<label for=section-67896e9afc9b4080d8c27b998062dd91 class=flex><a href=/inf1220-hugo/docs/modules/module3/ class=flex-auto>Module 3: Les structures de données, de contrôle et d'itération en Java</a></label><ul><li><a href=/inf1220-hugo/docs/modules/module3/pasapas/>Java pas à pas</a></li><li><a href=/inf1220-hugo/docs/modules/module3/github/>GitHub</a></li><li><a href=/inf1220-hugo/docs/modules/module3/activite-3-1/>Les structures de contrôle</a></li><li><a href=/inf1220-hugo/docs/modules/module3/activite-3-2/>Les structures itératives</a></li><li><a href=/inf1220-hugo/docs/modules/module3/activite-3-3-string/>Les chaînes de caractères (String)</a></li><li><a href=/inf1220-hugo/docs/modules/module3/activite-3-3/>Les structures de données de base</a></li><li><a href=/inf1220-hugo/docs/modules/module3/activite-3-3-random/>Les valeurs aléatoires</a></li><li><a href=/inf1220-hugo/docs/modules/module3/fonctionnel/>La programmation fonctionnelle en Java</a></li><li><a href=/inf1220-hugo/docs/modules/module3/exercices-3-1/>Exercices sur les structures de contrôle, les structures de données, les structures itératives</a></li><li><a href=/inf1220-hugo/docs/modules/module3/activite-3-4/>Les exceptions</a></li><li><a href=/inf1220-hugo/docs/modules/module3/activite-3-5/>La récursivité</a></li><li><a href=/inf1220-hugo/docs/modules/module3/exercices-3-2/>Exercices sur les exceptions et la récursivité</a></li><li><a href=/inf1220-hugo/docs/modules/module3/activite-3-3-modele/>Exemple : modèle de langue</a></li><li><a href=/inf1220-hugo/docs/modules/module3/conseils/>Recommandations</a></li><li><a href=/inf1220-hugo/docs/modules/module3/travail-note-3/>Travail noté 3</a></li></ul></li><li><input type=checkbox id=section-9087a4ffddbd9e1f0f2f4b3f8c85dcb4 class=toggle checked>
<label for=section-9087a4ffddbd9e1f0f2f4b3f8c85dcb4 class=flex><a href=/inf1220-hugo/docs/modules/module4/ class=flex-auto>Module 4: Les entrées et sorties</a></label><ul><li><a href=/inf1220-hugo/docs/modules/module4/pasapas/>Java pas à pas</a></li><li><a href=/inf1220-hugo/docs/modules/module4/activite-4-1/>Les flux de console</a></li><li><a href=/inf1220-hugo/docs/modules/module4/activite-4-2/ class=active>Les flux de données: lecture dans des fichiers et autres</a></li><li><a href=/inf1220-hugo/docs/modules/module4/exercices-4-1/>Exercices sur les flux</a></li><li><a href=/inf1220-hugo/docs/modules/module4/web/>Développement web</a></li><li><a href=/inf1220-hugo/docs/modules/module4/travail-note-4/>Travail noté 4</a></li></ul></li><li><input type=checkbox id=section-749269b787e65f29f734b50b6282d284 class=toggle>
<label for=section-749269b787e65f29f734b50b6282d284 class=flex><a href=/inf1220-hugo/docs/modules/module5/ class=flex-auto>Module 5. La programmation orientée objet: héritage et le polymorphisme</a></label><ul><li><a href=/inf1220-hugo/docs/modules/module5/pasapas/>Java pas à pas</a></li><li><a href=/inf1220-hugo/docs/modules/module5/activite-5-1/>L'héritage, les classes abstraites et les interfaces</a></li><li><a href=/inf1220-hugo/docs/modules/module5/activite-5-2/>Le polymorphisme</a></li><li><a href=/inf1220-hugo/docs/modules/module5/exercices-5-1/>Exercices sur l’héritage et le polymorphisme</a></li><li><a href=/inf1220-hugo/docs/modules/module5/travail-note-5/>Travail noté 5</a></li></ul></li><li><a href=/inf1220-hugo/docs/modules/examen/>Examen</a></li></ul></li><li><a href=/inf1220-hugo/docs/evaluation/>Évaluation</a></li><li><a href=/inf1220-hugo/docs/pensebete/>Pense-bête java</a></li><li><input type=checkbox id=section-5cc50cb3031bd6bd7b763bb20cfb7f0e class=toggle>
<label for=section-5cc50cb3031bd6bd7b763bb20cfb7f0e class=flex><a role=button class=flex-auto>Autres ressources</a></label><ul><li><a href=/inf1220-hugo/docs/extra/credits/>Le professeur</a></li><li><a href=/inf1220-hugo/docs/extra/feuille-de-route/>Feuille de route</a></li><li><a href=/inf1220-hugo/docs/extra/ressources/>Ressources</a></li><li><a href=/inf1220-hugo/docs/extra/faq/>FAQ</a></li><li><a href=/inf1220-hugo/docs/extra/manuel/>Manuel</a></li><li><a href=/inf1220-hugo/docs/extra/math/>Rappel mathématique</a></li><li><a href=/inf1220-hugo/docs/extra/ia/>Intelligence artificielle</a></li><li><a href=/inf1220-hugo/docs/extra/courriel/>Petit guide d’usage du courriel efficace</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/inf1220-hugo/svg/menu.svg class=book-icon alt=Menu></label><h3>Les flux de données: lecture dans des fichiers et autres</h3><label for=toc-control><img src=/inf1220-hugo/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#la-classe-file>La classe File</a></li><li><a href=#lecture-dun-fichier>Lecture d&rsquo;un fichier</a></li><li><a href=#écriture-dun-fichier-texte>Écriture d&rsquo;un fichier texte</a></li><li><a href=#stringwriter-et-stringreader>StringWriter et StringReader</a></li><li><a href=#données-binaries-en-mémoire>Données binaries en mémoire</a></li><li><a href=#path-et-files>Path et Files</a></li><li><a href=#fichiers-properties>Fichiers <em>properties</em></a></li><li><a href=#utf-8>UTF-8</a></li><li><a href=#boutisme>Boutisme</a></li><li><a href=#accès-à-linternet>Accès à l&rsquo;Internet</a></li><li><a href=#performance>Performance</a><ul><li><a href=#données-binaires-et-performance>Données binaires et performance</a></li><li><a href=#conseils-génériques>Conseils génériques</a></li><li><a href=#lecture-optionnelle-dans-le-livre-de-référence-delannoy>Lecture optionnelle dans le livre de référence (Delannoy)</a></li></ul></li><li><a href=#vidéo>Vidéo</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=les-flux-de-données-lecture-dans-des-fichiers-et-autres>Les flux de données: lecture dans des fichiers et autres
<a class=anchor href=#les-flux-de-donn%c3%a9es-lecture-dans-des-fichiers-et-autres>#</a></h1><p>Nous avons couvert la façon d'afficher des données à l'écran et de lire des données à partir du clavier en utilisant les flux de données (streams) dans les leçons précédentes. Quand nous avons utilisé les méthodes System.out.print ou System.out.println pour afficher des données à l'écran, ces dernières ont été envoyées sur un flux de sortie (output stream). Nous nous servirons des flux d'entrée et de sortie pour lire et écrire des données dans un fichier texte. Mais auparavant, il nous faut savoir comment créer le fichier dans lequel ces données seront archivées.</p><p>Pour manipuler les flux d'entrée et de sortie, nous utilisons les classes du package java.io. Les données sont manipulées suivant deux principes : la lecture/écriture en flux binaire ou en flux texte. Le tableau ci-dessous représente les différents flux que nous pouvons manipuler ainsi que les classes abstraites de base, l'implémentation, les fichiers et les tampons d'entrée-sortie qui leur sont associés.</p><table><thead><tr><th></th><th>Flux texte (lecture)</th><th>Flux texte (écriture)</th><th>Flux binaire (lecture)</th><th>Flux binaire (écriture)</th></tr></thead><tbody><tr><td>Classe abstraite de base</td><td>Reader</td><td>Writer</td><td>InputStream</td><td>OutputStream</td></tr><tr><td>Implémentation</td><td>InputStreamReader</td><td>PrintWriter</td><td>DataInputStream</td><td>DataOutputStream</td></tr><tr><td>Fichier</td><td>FileReader</td><td>FileWriter</td><td>FileInputStream</td><td>FileOutputStream</td></tr><tr><td>Buffer E/S</td><td>BufferedReader</td><td>BufferedWriter</td><td>BufferedInputStream</td><td>BufferedOutputStream</td></tr><tr><td>Mémoire</td><td>StringReader</td><td>StringWriter</td><td>ByteArrayInputStream</td><td>ByteArrayOutputStream</td></tr></tbody></table><h2 id=la-classe-file>La classe File
<a class=anchor href=#la-classe-file>#</a></h2><p>Pour travailler avec les fichiers et les répertoires, nous utilisons la classe File. Un objet de cette classe peut représenter un fichier ou un répertoire.<p>Il est très important de savoir qu&rsquo;il n&rsquo;est pas nécessaire d&rsquo;avoir physiquement le fichier ou le répertoire sur un disque avant d&rsquo;utiliser la classe File. Pour utiliser cette classe, nous devons intégrer le package java.io.* dans notre programme.</p><p>La classe File dispose d&rsquo;un constructeur qui prend en paramètre l&rsquo;emplacement du fichier que nous voulons créer. Si cet emplacement n&rsquo;est pas spécifié et que c&rsquo;est seulement le nom du fichier qui est passé en paramètre, ce dernier est créé dans le répertoire par défaut.</p></p><p>Pour créer un fichier, nous appelons le constructeur de la classe File de la façon suivante :</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>File<span style=color:#fff> </span>exempleFile1<span style=color:#0550ae>=</span><span style=color:#fff> </span><span style=color:#cf222e>new</span><span style=color:#fff> </span>File<span style=color:#fff> </span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;fichier&#34;</span><span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span>File<span style=color:#fff> </span>exempleFile2<span style=color:#0550ae>=</span><span style=color:#fff> </span><span style=color:#cf222e>new</span><span style=color:#fff> </span>File<span style=color:#fff> </span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;c:\exemple\unFichier.txt&#34;</span><span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span></code></pre></div><p>Dans le premier cas, un objet <a href=https://docs.oracle.com/javase/8/docs/api/java/io/File.html>File</a>, agissant comme référence vers le fichier dans l'arborescence du système de fichier, et ce pour un fichier du nom "fichier" dans le répertoire courant ("." dans Linux/Mac OS) sera crée. Dans le deuxième cas, une référence vers le fichier sur le disque "C:", dossier "/exemple", fichier "unFichier.txt" sera créée (exemple pour Windows ...). À ce stade, aucun fichier n'est crée ou ouvert, il ne s'agit que d'une référence vers l'emplacement possible d'un fichier. Pour savoir si le fichier existe ou non, il est possible d'utiliser la méthode exists() :</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>File<span style=color:#fff> </span>unFichier<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span><span style=color:#cf222e>new</span><span style=color:#fff> </span>File<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;lefichier&#34;</span><span style=color:#1f2328>);</span><span style=color:#fff> </span><span style=color:#57606a>// création d&#39;un objet fichier</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#cf222e>if</span><span style=color:#fff> </span><span style=color:#1f2328>(</span><span style=color:#0550ae>!</span>unFichier<span style=color:#1f2328>.</span><span style=color:#1f2328>exists</span><span style=color:#1f2328>())</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span>System<span style=color:#1f2328>.</span><span style=color:#1f2328>out</span><span style=color:#1f2328>.</span><span style=color:#1f2328>println</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;le fichier n&#39;existe pas!&#34;</span><span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span></code></pre></div><p>Pour créer un nouveau fichier sur un disque dur, il faut, dans un premier temps, créer l'objet File avec le nom du fichier voulu et, par la suite, utiliser la méthode createNewFile(), comme le montre le code ci-dessous :</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>File<span style=color:#fff> </span>unFichier<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span><span style=color:#cf222e>new</span><span style=color:#fff> </span>File<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;lefichier&#34;</span><span style=color:#1f2328>);</span><span style=color:#fff> </span><span style=color:#57606a>// création d&#39;un objet fichier</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#cf222e>if</span><span style=color:#fff> </span><span style=color:#1f2328>(</span>unFichier<span style=color:#1f2328>.</span><span style=color:#1f2328>createNewFile</span><span style=color:#1f2328>())</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>       </span>System<span style=color:#1f2328>.</span><span style=color:#1f2328>out</span><span style=color:#1f2328>.</span><span style=color:#1f2328>println</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;le fichier est créé!&#34;</span><span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#1f2328>}</span><span style=color:#fff> </span><span style=color:#cf222e>else</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>       </span>System<span style=color:#1f2328>.</span><span style=color:#1f2328>out</span><span style=color:#1f2328>.</span><span style=color:#1f2328>println</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;le fichier ne pas être créé&#34;</span><span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span></code></pre></div><h2 id=lecture-dun-fichier>Lecture d&rsquo;un fichier
<a class=anchor href=#lecture-dun-fichier>#</a></h2><h2>Lecture dans un fichier de bas niveau</h2><p>En informatique, on fait référence à une approche de <em>bas niveau</em> quand celle-ci demande au programmeur de tenir compte de plus de détails techniques. Les approche de bas niveau demandent plus d'effort, mais peuvent offrir plus de flexibilité.</p><p>Java possède deux classes, à savoir FileReader et File, qui nous permettent de lire un fichier texte de bas niveau. Pour cela, nous devons connaître le fichier que nous voulons lire. Pour cette leçon, nous avons choisi de lire le fichier unfichier.</p><p>Pour lire un fichier, nous devons d'abord construire un objet de type File (la classe File), qui prend comme paramètre le nom du fichier à lire. Ici, il s'agit de unfichier, et nous obtenons :</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#cf222e>try</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span>FileReader<span style=color:#fff> </span>fichierALire<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span><span style=color:#cf222e>new</span><span style=color:#fff> </span>FileReader<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;unfichier&#34;</span><span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#57606a>// ou bien en utilisant l&#39;objet File dans le constructeur</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span>File<span style=color:#fff> </span>file<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span><span style=color:#cf222e>new</span><span style=color:#fff> </span>File<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;unFichier&#34;</span><span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span>fichierALire<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span><span style=color:#cf222e>new</span><span style=color:#fff> </span>FileReader<span style=color:#1f2328>(</span>file<span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#1f2328>}</span><span style=color:#fff> </span><span style=color:#cf222e>catch</span><span style=color:#fff> </span><span style=color:#1f2328>(</span>IOException<span style=color:#fff> </span>exception<span style=color:#1f2328>)</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span>System<span style=color:#1f2328>.</span><span style=color:#1f2328>out</span><span style=color:#1f2328>.</span><span style=color:#1f2328>println</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;Le fichier n&#39;a pas été trouvé&#34;</span><span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span></code></pre></div><p>Note: dans cet exemple, la variable fichierALire est déclarée comme étant de type FileReader lors de sa première utilisation. On ne peut déclarer une même variable qu'une seule fois. On peut cependant réassigner la variable à une autre valeur. Il est donc légal d'écrire "FileReader fichierALire = new ..." suivi de "fichierALire = new ..." (sans répéter le nom de la classe, FileReader). Par contre, il serait illégal en Java d'écrire "FileReader fichierALire = new ..." suivi de "FileReader fichierALire = new ..." dans le même contexte puisqu'on déclarerait la variable deux fois.</p><p>Nous venons juste de créer une instance de l'objet FileReader permettant de lire le contenu d'un fichier. Cependant, la classe FileReader ne possède que des méthodes pouvant lire «&nbsp;en bas niveau&nbsp;», c'est-à-dire que la méthode read permet de lire caractère par caractère le contenu d'un fichier. Cette méthode peut lever une exception si, par exemple, nous ne pouvons accéder au disque dur ou si le fichier en question est protégé. Voici comment lire un caractère d'un fichier :</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#cf222e>try</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span>FileReader<span style=color:#fff> </span>fichierALire<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span><span style=color:#cf222e>new</span><span style=color:#fff> </span>FileReader<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;unfichier&#34;</span><span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#cf222e>char</span><span style=color:#fff> </span>caractere<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span><span style=color:#1f2328>(</span><span style=color:#cf222e>char</span><span style=color:#1f2328>)</span><span style=color:#fff> </span>fichierALire<span style=color:#1f2328>.</span><span style=color:#1f2328>read</span><span style=color:#1f2328>();</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span>System<span style=color:#1f2328>.</span><span style=color:#1f2328>out</span><span style=color:#1f2328>.</span><span style=color:#1f2328>print</span><span style=color:#1f2328>(</span>caractere<span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#1f2328>}</span><span style=color:#fff> </span><span style=color:#cf222e>catch</span><span style=color:#fff> </span><span style=color:#1f2328>(</span>FileNotFoundException<span style=color:#fff> </span>exception<span style=color:#1f2328>)</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span>System<span style=color:#1f2328>.</span><span style=color:#1f2328>out</span><span style=color:#1f2328>.</span><span style=color:#1f2328>println</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;Il y a une erreur lors de la lecture: &#34;</span><span style=color:#fff> </span><span style=color:#0550ae>+</span><span style=color:#fff> </span>exception<span style=color:#1f2328>.</span><span style=color:#1f2328>getMessage</span><span style=color:#1f2328>());</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span></code></pre></div><p>Avec tout ce que nous avons vu jusqu'à présent, nous ne pouvons écrire qu'un seul caractère à l'écran. À chaque appel de la méthode read, un caractère est lu. Pour lire un fichier en entier, il faut donc vérifier si la méthode read renvoie -1 car c'est cette valeur qui indique la fin d'un fichier. Le code ci-dessous montre comment nous pouvons procéder :</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#cf222e>try</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span>FileReader<span style=color:#fff> </span>fichierALire<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span><span style=color:#cf222e>new</span><span style=color:#fff> </span>FileReader<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;unfichier&#34;</span><span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#cf222e>int</span><span style=color:#fff> </span>c<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span>fichierALire<span style=color:#1f2328>.</span><span style=color:#1f2328>read</span><span style=color:#1f2328>();</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#cf222e>while</span><span style=color:#fff> </span><span style=color:#1f2328>(</span>c<span style=color:#fff> </span><span style=color:#0550ae>!=</span><span style=color:#fff> </span><span style=color:#0550ae>-</span>1<span style=color:#1f2328>)</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#57606a>// tant que nous ne sommes pas à la fin du fichier</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>        </span>System<span style=color:#1f2328>.</span><span style=color:#1f2328>out</span><span style=color:#1f2328>.</span><span style=color:#1f2328>print</span><span style=color:#1f2328>((</span><span style=color:#cf222e>char</span><span style=color:#1f2328>)</span><span style=color:#fff> </span>c<span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>        </span>c<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span>fichierALire<span style=color:#1f2328>.</span><span style=color:#1f2328>read</span><span style=color:#1f2328>();</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#1f2328>}</span><span style=color:#fff> </span><span style=color:#cf222e>catch</span><span style=color:#fff> </span><span style=color:#1f2328>(</span>IOException<span style=color:#fff> </span>exception<span style=color:#1f2328>)</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span>System<span style=color:#1f2328>.</span><span style=color:#1f2328>out</span><span style=color:#1f2328>.</span><span style=color:#1f2328>println</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;Il y a une erreur lors de la lecture: &#34;</span><span style=color:#fff> </span><span style=color:#0550ae>+</span><span style=color:#fff> </span>exception<span style=color:#1f2328>.</span><span style=color:#1f2328>getMessage</span><span style=color:#1f2328>());</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span></code></pre></div><p>Pour terminer, il ne reste qu'à fermer le FileReader, en effet, lorsqu'un programme effectue une opération d'entrée-sortie, celui-ci doit demander de l'aide au système d'exploitation et ce dernier va mobiliser des ressources comme le disque dur. Une fois l'opération d'entrée-sortie terminée, vous devez le signaler pour que le système d'opération puisse libérer les ressources que vous n'utilisez plus. En Java, il suffit simplement de faire appel à la méthode close comme indiqué ci-dessous.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>fichierALire<span style=color:#1f2328>.</span><span style=color:#1f2328>close</span><span style=color:#1f2328>();</span><span style=color:#fff>
</span></span></span></code></pre></div><h2>Lecture dans un fichier de haut niveau</h2><p>Nous venons de terminer la lecture de bas niveau d'un fichier. Nous abordons maintenant celle de haut niveau, car la classe FileReader n'est pas très efficace. En effet, elle pourrait s'avérer longue en raison du nombre impressionnant d'appels à la méthode read qu'elle devrait faire. La classe BufferedReader permet pour sa part de lire un fichier texte avec des fonctions de niveau supérieur. Avec ces fonctions, nous pouvons, par exemple, lire un fichier texte ligne par ligne.</p><p>Pour une lecture de haut niveau d'un fichier avec les fonctions de la classe BufferedReader, il faut créer un objet de type BufferedReader qui doit prendre en paramètre un type Reader et lui donner un objet FileReader. Pour ce faire, il faut d'abord créer le fichier à lire. Le code ci-dessous explique mieux la façon à suivre :</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#cf222e>try</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span>File<span style=color:#fff> </span>FichierALire<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span><span style=color:#cf222e>new</span><span style=color:#fff> </span>File<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;textfichier&#34;</span><span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span>FileReader<span style=color:#fff> </span>unFichier<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span><span style=color:#cf222e>new</span><span style=color:#fff> </span>FileReader<span style=color:#1f2328>(</span>FichierALire<span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span>BufferedReader<span style=color:#fff> </span>leBuffer<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span><span style=color:#cf222e>new</span><span style=color:#fff> </span>BufferedReader<span style=color:#1f2328>(</span>unFichier<span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#1f2328>}</span><span style=color:#fff> </span><span style=color:#cf222e>catch</span><span style=color:#fff> </span><span style=color:#1f2328>(</span>FileNotFoundException<span style=color:#fff> </span>exception<span style=color:#1f2328>)</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span>System<span style=color:#1f2328>.</span><span style=color:#1f2328>out</span><span style=color:#1f2328>.</span><span style=color:#1f2328>println</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34; Fichier introuvable!&#34;</span><span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span></code></pre></div><p>Pour lire maintenant le fichier créé, nous devons utiliser la méthode readLine, qui le fait ligne par ligne et retourne null à la fin du fichier. Nous pouvons réaliser cela grâce au code ci-dessous :</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#cf222e>try</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span>String<span style=color:#fff> </span>uneligne<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span>leBuffer<span style=color:#1f2328>.</span><span style=color:#1f2328>readLine</span><span style=color:#1f2328>();</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#cf222e>while</span><span style=color:#fff> </span><span style=color:#1f2328>(</span>uneligne<span style=color:#fff> </span><span style=color:#0550ae>!=</span><span style=color:#fff> </span><span style=color:#cf222e>null</span><span style=color:#1f2328>)</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>        </span>System<span style=color:#1f2328>.</span><span style=color:#1f2328>out</span><span style=color:#1f2328>.</span><span style=color:#1f2328>println</span><span style=color:#1f2328>(</span>uneligne<span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>        </span>uneligne<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span>leBuffer<span style=color:#1f2328>.</span><span style=color:#1f2328>readLine</span><span style=color:#1f2328>();</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span>leBuffer<span style=color:#1f2328>.</span><span style=color:#1f2328>close</span><span style=color:#1f2328>();</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span>unFichier<span style=color:#1f2328>.</span><span style=color:#1f2328>close</span><span style=color:#1f2328>();</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#1f2328>}</span><span style=color:#fff> </span><span style=color:#cf222e>catch</span><span style=color:#fff> </span><span style=color:#1f2328>(</span>IOException<span style=color:#fff> </span>exception<span style=color:#1f2328>)</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span>System<span style=color:#1f2328>.</span><span style=color:#1f2328>out</span><span style=color:#1f2328>.</span><span style=color:#1f2328>println</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;Il y a une erreur lors de la lecture: &#34;</span><span style=color:#fff> </span><span style=color:#0550ae>+</span><span style=color:#fff> </span>exception<span style=color:#1f2328>.</span><span style=color:#1f2328>getMessage</span><span style=color:#1f2328>());</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span></code></pre></div><h2 id=écriture-dun-fichier-texte>Écriture d&rsquo;un fichier texte
<a class=anchor href=#%c3%a9criture-dun-fichier-texte>#</a></h2><p>Nous aborderons maintenant l'écriture de données vers un fichier texte. Cette dernière sert à les stocker lorsque le programme ne s'exécute plus et en vue de pouvoir les récupérer plus tard ou les envoyer à d'autres personnes. Comme vous le verrez, l'écriture de fichiers texte est assez similaire à leur lecture. Pour écrire, nous allons utiliser les trois classes suivantes FileWriter, BufferedWriter et PrintWriter.</p><h2>Écriture de bas niveau</h2><p>Pour écrire dans un fichier, nous utilisons la classe FileWriter. Nous commençons par créer un objet File qui sera le fichier vers lequel nous désirons écrire. Par la suite, nous produirons l'objet FileWriter. Le fichier représenté par l'objet File sera créé s'il n'existe pas. Dans le cas contraire, le contenu de ce fichier sera complètement écrasé. La classe FileWriter offre des méthodes de bas niveau pour l'écriture. Nous trouvons plusieurs méthodes dont Write pour écrire un caractère, une partie de String ou enfin un String complet. Le code ci-dessous démontre comment écrire des données dans un fichier :</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#cf222e>double</span><span style=color:#0550ae>[]</span><span style=color:#fff> </span>notes<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span><span style=color:#1f2328>{</span>95<span style=color:#1f2328>.</span><span style=color:#1f2328>5</span><span style=color:#1f2328>,</span><span style=color:#fff> </span>91<span style=color:#1f2328>.</span><span style=color:#1f2328>5</span><span style=color:#1f2328>,</span><span style=color:#fff> </span>78<span style=color:#1f2328>.</span><span style=color:#1f2328>5</span><span style=color:#1f2328>,</span><span style=color:#fff> </span>75<span style=color:#1f2328>.</span><span style=color:#1f2328>0</span><span style=color:#1f2328>,</span><span style=color:#fff> </span>81<span style=color:#1f2328>.</span><span style=color:#1f2328>50</span><span style=color:#1f2328>};</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span>File<span style=color:#fff> </span>fichier<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span><span style=color:#cf222e>new</span><span style=color:#fff> </span>File<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;notes.txt&#34;</span><span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#cf222e>try</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span>FileWriter<span style=color:#fff> </span>fichierEcriture<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span><span style=color:#cf222e>new</span><span style=color:#fff> </span>FileWriter<span style=color:#1f2328>(</span>fichier<span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#cf222e>for</span><span style=color:#fff> </span><span style=color:#1f2328>(</span><span style=color:#cf222e>double</span><span style=color:#fff> </span>lanote<span style=color:#fff> </span><span style=color:#1f2328>:</span><span style=color:#fff> </span>notes<span style=color:#1f2328>)</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>        </span>fichierEcriture<span style=color:#1f2328>.</span><span style=color:#1f2328>write</span><span style=color:#1f2328>(</span>String<span style=color:#1f2328>.</span><span style=color:#1f2328>valueOf</span><span style=color:#1f2328>(</span>lanote<span style=color:#1f2328>));</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>        </span>fichierEcriture<span style=color:#1f2328>.</span><span style=color:#1f2328>write</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;\r\n&#34;</span><span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span>fichierEcriture<span style=color:#1f2328>.</span><span style=color:#1f2328>close</span><span style=color:#1f2328>();</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#1f2328>}</span><span style=color:#fff> </span><span style=color:#cf222e>catch</span><span style=color:#fff> </span><span style=color:#1f2328>(</span>IOException<span style=color:#fff> </span>exception<span style=color:#1f2328>)</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span>System<span style=color:#1f2328>.</span><span style=color:#1f2328>out</span><span style=color:#1f2328>.</span><span style=color:#1f2328>println</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;Erreur lors de la lecture : &#34;</span><span style=color:#fff> </span><span style=color:#0550ae>+</span><span style=color:#fff> </span>exception<span style=color:#1f2328>.</span><span style=color:#1f2328>getMessage</span><span style=color:#1f2328>());</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span></code></pre></div><h2>Écriture de haut niveau</h2><p>Les méthodes proposées par la classe FileWriter sont de bas niveau. Par contre, d'autres classes offrant des méthodes de plus haut niveau qui accélèrent et rendent plus facile l'écriture vers un fichier texte. Nous avons la classe BufferedWriter qui offre des méthodes de plus haut niveau et une écriture plus rapide et performante. Son fonctionnement est assez similaire à la celui de la classe BufferedReader.
La classe BufferedWriter permet d'avoir une écriture plus performante. Elle propose une méthode supplémentaire, newLine, qui ajoute un retour à la ligne. Le retour à la ligne dans un fichier texte dépend du système d'exploitation ( \r\n sous Windows, \n sous Unix, ...). Alors, il est préférable d'utiliser cette méthode qui peut être portable.</p><p>Il faut donc utiliser une autre classe en plus, par exemple la classe PrintWriter qui se comporte de manière semblable à la classe PrintStream dont l'objet System.out est une instance. Nous pouvons donc réécrire le programme précédent avec ces nouveaux objets pour obtenir une écriture de meilleur rendement.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#cf222e>double</span><span style=color:#0550ae>[]</span><span style=color:#fff> </span>notes<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span><span style=color:#1f2328>{</span>95<span style=color:#1f2328>.</span><span style=color:#1f2328>5</span><span style=color:#1f2328>,</span><span style=color:#fff> </span>91<span style=color:#1f2328>.</span><span style=color:#1f2328>5</span><span style=color:#1f2328>,</span><span style=color:#fff> </span>78<span style=color:#1f2328>.</span><span style=color:#1f2328>5</span><span style=color:#1f2328>,</span><span style=color:#fff> </span>75<span style=color:#1f2328>.</span><span style=color:#1f2328>0</span><span style=color:#1f2328>,</span><span style=color:#fff> </span>81<span style=color:#1f2328>.</span><span style=color:#1f2328>50</span><span style=color:#1f2328>};</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span>File<span style=color:#fff> </span>fichier<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span><span style=color:#cf222e>new</span><span style=color:#fff> </span>File<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;notes.txt&#34;</span><span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#cf222e>try</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span>PrintWriter<span style=color:#fff> </span>fichierAEcrire<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span><span style=color:#cf222e>new</span><span style=color:#fff> </span>PrintWriter<span style=color:#1f2328>(</span><span style=color:#cf222e>new</span><span style=color:#fff> </span>BufferedWriter<span style=color:#1f2328>(</span><span style=color:#cf222e>new</span><span style=color:#fff> </span>FileWriter<span style=color:#1f2328>(</span>fichier<span style=color:#1f2328>)));</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#cf222e>for</span><span style=color:#fff> </span><span style=color:#1f2328>(</span><span style=color:#cf222e>double</span><span style=color:#fff> </span>lanote<span style=color:#fff> </span><span style=color:#1f2328>:</span><span style=color:#fff> </span>notes<span style=color:#1f2328>)</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>        </span>fichierAEcrire<span style=color:#1f2328>.</span><span style=color:#1f2328>println</span><span style=color:#1f2328>(</span>lanote<span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span>fichierAEcrire<span style=color:#1f2328>.</span><span style=color:#1f2328>close</span><span style=color:#1f2328>();</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#1f2328>}</span><span style=color:#fff> </span><span style=color:#cf222e>catch</span><span style=color:#fff> </span><span style=color:#1f2328>(</span>IOException<span style=color:#fff> </span>exception<span style=color:#1f2328>)</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span>System<span style=color:#1f2328>.</span><span style=color:#1f2328>out</span><span style=color:#1f2328>.</span><span style=color:#1f2328>println</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;Erreur lors de la lecture : &#34;</span><span style=color:#fff> </span><span style=color:#0550ae>+</span><span style=color:#fff> </span>exception<span style=color:#1f2328>.</span><span style=color:#1f2328>getMessage</span><span style=color:#1f2328>());</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span></code></pre></div><h2>Écriture d'un fichier texte avec PrintWriter</h2><p>Nous utilisons donc un PrintWriter (pour les méthodes de haut niveau) par-dessus un BufferedWriter (pour l'écriture rapide) sur un FileWriter (pour l'écriture vers un fichier texte).
Il faut noter qu'avec la classe PrintWriter, nous pouvons utiliser des méthodes de haut niveau comme println qui ajoutent une ligne au fichier texte. Cependant, il existe d'autres méthodes très riches comme printf pour les sorties formatées par exemple. Le code ci-dessous montre comment utiliser PrintWriter :</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>PrintWriter<span style=color:#fff> </span>sortie<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span><span style=color:#cf222e>null</span><span style=color:#1f2328>;</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#cf222e>try</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span>System<span style=color:#1f2328>.</span><span style=color:#1f2328>out</span><span style=color:#1f2328>.</span><span style=color:#1f2328>println</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;Plus grand diviseur commun :&#34;</span><span style=color:#fff> </span><span style=color:#0550ae>+</span><span style=color:#fff> </span>plusGrandCommunDiviseur<span style=color:#1f2328>(</span>455<span style=color:#1f2328>,</span>322<span style=color:#1f2328>)</span><span style=color:#fff> </span><span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span>File<span style=color:#fff> </span>fichier<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span><span style=color:#cf222e>new</span><span style=color:#fff> </span>File<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;fichier.txt&#34;</span><span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span>sortie<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span><span style=color:#cf222e>new</span><span style=color:#fff> </span>PrintWriter<span style=color:#1f2328>(</span><span style=color:#cf222e>new</span><span style=color:#fff> </span>BufferedWriter<span style=color:#1f2328>(</span><span style=color:#cf222e>new</span><span style=color:#fff> </span>FileWriter<span style=color:#1f2328>(</span>fichier<span style=color:#1f2328>)));</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span>sortie<span style=color:#1f2328>.</span><span style=color:#1f2328>println</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;Une ligne de texte&#34;</span><span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#1f2328>}</span><span style=color:#fff> </span><span style=color:#cf222e>catch</span><span style=color:#fff> </span><span style=color:#1f2328>(</span>IOException<span style=color:#fff> </span>ex<span style=color:#1f2328>)</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span>Logger<span style=color:#1f2328>.</span><span style=color:#1f2328>getLogger</span><span style=color:#1f2328>(</span>ExempleRecursivite<span style=color:#1f2328>.</span><span style=color:#1f2328>class</span><span style=color:#1f2328>.</span><span style=color:#1f2328>getName</span><span style=color:#1f2328>()).</span><span style=color:#1f2328>log</span><span style=color:#1f2328>(</span>Level<span style=color:#1f2328>.</span><span style=color:#1f2328>SEVERE</span><span style=color:#1f2328>,</span><span style=color:#fff> </span><span style=color:#cf222e>null</span><span style=color:#1f2328>,</span><span style=color:#fff> </span>ex<span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#1f2328>}</span><span style=color:#fff> </span><span style=color:#cf222e>finally</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span>sortie<span style=color:#1f2328>.</span><span style=color:#1f2328>close</span><span style=color:#1f2328>();</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span></code></pre></div><h2>Approche simplifiée</h2><p>La gestion des cas d'exception et de la nécessité de fermer les fichiers avant de terminer la fonction est pénible. Heureusement, on peut faire mieux si on dispose d'une version récente de Java (Java 8 ou mieux). Toutes les classes nécessitant d'être fermée ("close") peuvent être déclarée dans le "try" comme ceci:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#cf222e>import</span><span style=color:#fff> </span><span style=color:#24292e>java.io.*</span><span style=color:#1f2328>;</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#cf222e>class</span> <span style=color:#1f2328>MaClasse</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>  </span><span style=color:#cf222e>public</span><span style=color:#fff> </span><span style=color:#cf222e>static</span><span style=color:#fff> </span><span style=color:#cf222e>void</span><span style=color:#fff> </span><span style=color:#6639ba>main</span><span style=color:#1f2328>(</span>String<span style=color:#0550ae>[]</span><span style=color:#fff> </span>args<span style=color:#1f2328>)</span><span style=color:#fff> </span><span style=color:#cf222e>throws</span><span style=color:#fff> </span>IOException<span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>   </span>File<span style=color:#fff> </span>unFichier<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span><span style=color:#cf222e>new</span><span style=color:#fff> </span>File<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;monfichier&#34;</span><span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>   </span><span style=color:#cf222e>try</span><span style=color:#fff> </span><span style=color:#1f2328>(</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>     </span>BufferedReader<span style=color:#fff> </span>leBuffer<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span><span style=color:#cf222e>new</span><span style=color:#fff> </span>BufferedReader<span style=color:#1f2328>(</span><span style=color:#cf222e>new</span><span style=color:#fff> </span>FileReader<span style=color:#1f2328>(</span>unFichier<span style=color:#1f2328>));</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#1f2328>)</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>     </span>System<span style=color:#1f2328>.</span><span style=color:#1f2328>out</span><span style=color:#1f2328>.</span><span style=color:#1f2328>println</span><span style=color:#1f2328>(</span>leBuffer<span style=color:#1f2328>.</span><span style=color:#1f2328>readLine</span><span style=color:#1f2328>());</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#1f2328>}</span><span style=color:#fff> </span><span style=color:#cf222e>catch</span><span style=color:#fff> </span><span style=color:#1f2328>(</span>FileNotFoundException<span style=color:#fff> </span>exception<span style=color:#1f2328>)</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>      </span>System<span style=color:#1f2328>.</span><span style=color:#1f2328>out</span><span style=color:#1f2328>.</span><span style=color:#1f2328>println</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34; Fichier introuvable!&#34;</span><span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>  </span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span></code></pre></div><h2 id=stringwriter-et-stringreader>StringWriter et StringReader
<a class=anchor href=#stringwriter-et-stringreader>#</a></h2><p>StringWriter et StringReader sont des classes du package java.io en Java, conçues pour manipuler des données textuelles en mémoire sous forme de chaînes. StringWriter accumule les données écrites dans un StringBuffer interne, permettant de récupérer le contenu sous forme de String via toString() ou getBuffer(). Elle est utile pour générer du texte dynamiquement sans écrire directement dans un fichier ou un flux. StringReader lit des données à partir d’une String comme si elle provenait d’un flux, offrant une interface pratique pour parser ou traiter une chaîne comme un flux de caractères. Ces classes sont particulièrement adaptées pour des opérations intermédiaires, comme la conversion de données avant leur sérialisation ou désérialisation.</p><div class=java-inline><div id=java-runner-1752020650615165143><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/eclipse.min.css><style>#java-runner-1752020650615165143 .export-form textarea{width:100%;min-height:120px;font-family:monospace;border-radius:4px;border:1px solid #ccc}#java-runner-1752020650615165143 .export-form{margin-bottom:0}#java-runner-1752020650615165143 .export-result{background:#222;color:#eee;padding:12px;border-radius:6px;margin-top:16px;white-space:pre-wrap;font-family:monospace}#java-runner-1752020650615165143 .export-endpoint-info{color:#1976d2;font-size:.98em;margin-top:8px}#java-runner-1752020650615165143 .export-btn{background:#1976d2;color:#fff;border:none;border-radius:4px;padding:8px 16px;font-size:1em;cursor:pointer;margin-top:8px}#java-runner-1752020650615165143 .export-file-block{max-width:100%;flex:1 1 350px;background:#f9f9f9;border:1px solid #ddd;border-radius:6px;padding:12px;margin-bottom:8px}#java-runner-1752020650615165143 .export-file-block .export-file-name{font-weight:700;margin-bottom:4px}.cm-java-error{background:#ffe0e0 !important;border-bottom:2px dotted #c00;cursor:pointer}.cm-java-error-line{background:#fff0f0 !important}</style><form class="export-form java-runner-1752020650615165143-form" style=margin-bottom:0><input type=hidden class=export-endpoint-var value=https://flask-service-inf1220-java.90qakjuvfj4f8.ca-central-1.cs.amazonlightsail.com/run><div style=display:flex;gap:12px;flex-wrap:wrap><div class=export-file-block><div class=export-file-name>StringWriterReaderExample.java</div><textarea>
import java.io.StringWriter;
import java.io.StringReader;
import java.io.BufferedReader;
import java.io.IOException;

public class StringWriterReaderExample {
    public static void main(String[] args) {
        // Étape 1 : Utilisation de StringWriter pour créer une chaîne
        StringWriter writer = new StringWriter();
        writer.write(&#34;param1=valeur1\n&#34;);
        writer.write(&#34;param2=valeur2\n&#34;);
        writer.write(&#34;param3=valeur3\n&#34;);
        System.out.println(&#34;Contenu généré par StringWriter :\n&#34; &#43; writer.toString());

        // Étape 2 : Utilisation de StringReader pour lire la chaîne
        StringReader reader = new StringReader(writer.toString());
        try (BufferedReader bufferedReader = new BufferedReader(reader)) {
            System.out.println(&#34;\nLecture ligne par ligne avec StringReader :&#34;);
            String ligne;
            while ((ligne = bufferedReader.readLine()) != null) {
                System.out.println(&#34;Ligne : &#34; &#43; ligne);
            }
        } catch (IOException e) {
            System.err.println(&#34;Erreur lors de la lecture : &#34; &#43; e.getMessage());
        }
    }
}
</textarea></div></div><button type=submit class="export-btn java-runner-1752020650615165143-btn" style="background:#1976d2;color:#fff;border:none;border-radius:4px;padding:8px 16px;font-size:1em;cursor:pointer;margin-top:8px">Exécuter</button></form><div class=export-result></div><div class=java-error-tooltip style="display:none;position:absolute;z-index:1000;background:#fff0f0;color:#c00;border:1px solid #c00;padding:6px 12px;border-radius:6px;font-size:1em;box-shadow:0 2px 8px #0002"></div><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/clike/clike.min.js></script><script>(function(){var t,n,s,o,e=document.getElementById("java-runner-1752020650615165143");if(!e)return;s=e.querySelector("form"),t=e.querySelector(".export-result"),o=s.querySelector(".export-endpoint-var").value,n=e.querySelector(".java-error-tooltip"),e.querySelectorAll(".export-file-block").forEach(function(e){var t,n,s=e.querySelector(".export-file-name").textContent,o=e.querySelector("textarea");s.endsWith(".java")&&(n=CodeMirror.fromTextArea(o,{mode:"text/x-java",theme:"eclipse",lineNumbers:!0,indentUnit:4,tabSize:4}),e._cm=n,e._javaErrorLines={},n.on("cursorActivity",function(){var s,o,t=e.querySelector(".java-error-status-bar");if(!t)return;s=n.getCursor(),o=e._javaErrorLines&&e._javaErrorLines[s.line],o?(t.textContent="Ligne "+(s.line+1)+" : "+o,t.style.visibility="visible"):(t.textContent="",t.style.visibility="hidden")})),s.endsWith(".java")&&(e.querySelector(".java-error-status-bar")||(t=document.createElement("div"),t.className="java-error-status-bar",t.style.marginTop="4px",t.style.fontSize="0.95em",t.style.color="#c00",t.style.minHeight="1.2em",t.style.visibility="hidden",e.appendChild(t)))});function i(e,t,s){n.textContent=e,n.style.display="block",n.style.left=t+10+"px",n.style.top=s+10+"px"}function a(){n.style.display="none"}s.onsubmit=function(n){n.preventDefault();var s,i,a,r,c=[],l=[];e.querySelectorAll(".export-file-block").forEach(function(e){var t=e.querySelector(".export-file-name").textContent,s=e.querySelector("textarea"),n=e._cm?e._cm.getValue():s.value;t.endsWith(".java")?c.push({name:t,content:n}):l.push({name:t,content:n})}),s=0,t.textContent="Exécution en cours",i=setInterval(function(){s=(s+1)%4,t.textContent="Exécution en cours"+".".repeat(s)},500),a=new AbortController,r=setTimeout(function(){a.abort()},3e4),fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({java_files:c,txt_files:l}),signal:a.signal}).then(function(e){if(clearInterval(i),clearTimeout(r),!e.ok&&e.status!==400)throw new Error("Erreur HTTP "+e.status+" : "+e.statusText);return e.text()}).then(function(n){try{if(s=JSON.parse(n),s.status==="ran_successfully"?t.innerHTML='<pre style="color:#222;background:#e0ffe0;padding:12px;border-radius:6px;">'+(s.output||"").replace(/\n/g,"<br>")+"</pre>":s.status==="compiling"?t.innerHTML='<pre style="color:#c00;background:#ffe0e0;padding:12px;border-radius:6px;">'+(s.error||"").replace(/\n/g,"<br>")+"</pre>":s.status==="runtime_error"?t.innerHTML='<pre style="color:#c00;background:#ffe0e0;padding:12px;border-radius:6px;">'+(s.error||"").replace(/\n/g,"<br>")+"</pre>":t.textContent=n,s.status==="compiling"){for(c=s.error||"",l=new RegExp(`([\\w./\\-]+\\.java):(\\d+): error: ([^\\n]+)([\\s\\S]*?)(?=\\n[\\w./\\-]+\\.java:|$)`,"g"),e.querySelectorAll(".export-file-block").forEach(function(e){e._cm&&e._cm.operation(function(){for(var n=e._cm.getAllMarks(),t=0;t<n.length;t++)n[t].clear()}),e._javaErrorLines={};var t=e.querySelector(".java-error-status-bar");t&&(t.textContent="",t.style.visibility="hidden")});(o=l.exec(c))!==null;){var s,o,c,l,a=o[1],u=o[2],h=o[3],d=o[4],i=parseInt(u,10)-1,r=(h+(d?d.replace(/\s+/g," "):"")).trim();e.querySelectorAll(".export-file-block").forEach(function(e){var t=e.querySelector(".export-file-name");t&&(t.textContent.trim()===a||t.textContent.trim().endsWith("/"+a)||t.textContent.trim().endsWith("\\"+a))&&(e._cm&&e._cm.operation(function(){e._cm.markText({line:i,ch:0},{line:i+1,ch:0},{className:"cm-java-error",title:r})}),e._javaErrorLines||(e._javaErrorLines={}),e._javaErrorLines[i]=r)})}e.querySelectorAll(".export-file-block").forEach(function(e){if(e._cm&&e._cm.getOption("lineNumbers")){var n,s,t=e.querySelector(".java-error-status-bar");t&&(n=e._cm.getCursor(),s=e._javaErrorLines&&e._javaErrorLines[n.line],s?(t.textContent="Ligne "+(n.line+1)+" : "+s,t.style.visibility="visible"):(t.textContent="",t.style.visibility="hidden"))}})}else e.querySelectorAll(".export-file-block").forEach(function(e){e._cm&&e._cm.operation(function(){for(var n=e._cm.getAllMarks(),t=0;t<n.length;t++)n[t].clear()}),e._javaErrorLines={};var t=e.querySelector(".java-error-status-bar");t&&(t.textContent="",t.style.visibility="hidden")})}catch(e){console.log(e),t.textContent=n}}).catch(function(e){clearInterval(i),clearTimeout(r),e.name==="AbortError"?t.textContent="Erreur : délai d’attente dépassé (30 secondes).":t.textContent="Erreur lors de la requête : "+e})},e.querySelectorAll(".export-file-block").forEach(function(e){var t=e._cm;if(!t)return;t.on("mouseover",function(t,n){var a,o=t.coordsChar({left:n.clientX,top:n.clientY}),s=o.line,c=o.ch,r=t.getCursor();s===r.line&&e._javaErrorLines&&e._javaErrorLines[s]&&(a=e._javaErrorLines[s],i(a,n.clientX,n.clientY))}),t.on("mouseout",function(){a()})})})()</script></div></div><h2 id=données-binaries-en-mémoire>Données binaries en mémoire
<a class=anchor href=#donn%c3%a9es-binaries-en-m%c3%a9moire>#</a></h2><p>ByteArrayInputStream et ByteArrayOutputStream sont des classes du package java.io en Java, conçues pour manipuler des données binaires en mémoire. ByteArrayInputStream permet de lire un tableau de bytes (byte[]) comme un flux d’entrée, simulant une source de données sans accès au disque. Elle est utile pour tester, parser des données binaires ou réutiliser des bytes existants. ByteArrayOutputStream accumule les octets écrits dans un buffer interne, que l’on peut récupérer via toByteArray() ou convertir en chaîne. Cette classe est idéale pour générer des données binaires, comme des sérialisations ou des contenus à envoyer sur un réseau, sans écrire immédiatement sur un fichier.</p><div class=java-inline><div id=java-runner-1752020650615237800><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/eclipse.min.css><style>#java-runner-1752020650615237800 .export-form textarea{width:100%;min-height:120px;font-family:monospace;border-radius:4px;border:1px solid #ccc}#java-runner-1752020650615237800 .export-form{margin-bottom:0}#java-runner-1752020650615237800 .export-result{background:#222;color:#eee;padding:12px;border-radius:6px;margin-top:16px;white-space:pre-wrap;font-family:monospace}#java-runner-1752020650615237800 .export-endpoint-info{color:#1976d2;font-size:.98em;margin-top:8px}#java-runner-1752020650615237800 .export-btn{background:#1976d2;color:#fff;border:none;border-radius:4px;padding:8px 16px;font-size:1em;cursor:pointer;margin-top:8px}#java-runner-1752020650615237800 .export-file-block{max-width:100%;flex:1 1 350px;background:#f9f9f9;border:1px solid #ddd;border-radius:6px;padding:12px;margin-bottom:8px}#java-runner-1752020650615237800 .export-file-block .export-file-name{font-weight:700;margin-bottom:4px}.cm-java-error{background:#ffe0e0 !important;border-bottom:2px dotted #c00;cursor:pointer}.cm-java-error-line{background:#fff0f0 !important}</style><form class="export-form java-runner-1752020650615237800-form" style=margin-bottom:0><input type=hidden class=export-endpoint-var value=https://flask-service-inf1220-java.90qakjuvfj4f8.ca-central-1.cs.amazonlightsail.com/run><div style=display:flex;gap:12px;flex-wrap:wrap><div class=export-file-block><div class=export-file-name>ByteArrayStreamExample.java</div><textarea>
import java.io.ByteArrayOutputStream;
import java.io.ByteArrayInputStream;
import java.io.IOException;
import java.nio.charset.StandardCharsets; // Recommandé pour spécifier les jeux de caractères

public class ByteArrayStreamExample {
    public static void main(String[] args) {
        // Étape 1 : Utilisation de ByteArrayOutputStream pour écrire des données
        // Utilisation de try-with-resources pour s&#39;assurer que le flux est fermé automatiquement
        try (ByteArrayOutputStream outputStream = new ByteArrayOutputStream()) {
            String message = &#34;Bonjour Java&#34;;
            outputStream.write(message.getBytes(StandardCharsets.UTF_8)); // Utiliser StandardCharsets
            outputStream.write(33); // Ajout d&#39;un octet (caractère &#39;!&#39;)

            byte[] bytesWritten = outputStream.toByteArray();
            System.out.println(&#34;Contenu de ByteArrayOutputStream (taille) : &#34; &#43; bytesWritten.length &#43; &#34; octets&#34;);
            System.out.println(&#34;Contenu écrit : &#34; &#43; new String(bytesWritten, StandardCharsets.UTF_8)); // Afficher le contenu écrit

            // Étape 2 : Utilisation de ByteArrayInputStream pour lire les données
            // ByteArrayInputStream n&#39;a pas strictement besoin d&#39;être fermé car il opère sur un tableau d&#39;octets,
            // mais c&#39;est une bonne pratique pour la cohérence ou s&#39;il s&#39;agissait d&#39;un autre type de flux.
            try (ByteArrayInputStream inputStream = new ByteArrayInputStream(bytesWritten)) {
                System.out.println(&#34;\nLecture avec ByteArrayInputStream :&#34;);
                int byteRead;
                while ((byteRead = inputStream.read()) != -1) {
                    System.out.print((char) byteRead);
                }
                System.out.println();
            }
        } catch (IOException e) {
            // Capture des IOException potentielles lors des opérations de flux ou de l&#39;encodage du jeu de caractères
            System.err.println(&#34;Une erreur s&#39;est produite lors des opérations de flux : &#34; &#43; e.getMessage());
        }
    }
}
</textarea></div></div><button type=submit class="export-btn java-runner-1752020650615237800-btn" style="background:#1976d2;color:#fff;border:none;border-radius:4px;padding:8px 16px;font-size:1em;cursor:pointer;margin-top:8px">Exécuter</button></form><div class=export-result></div><div class=java-error-tooltip style="display:none;position:absolute;z-index:1000;background:#fff0f0;color:#c00;border:1px solid #c00;padding:6px 12px;border-radius:6px;font-size:1em;box-shadow:0 2px 8px #0002"></div><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/clike/clike.min.js></script><script>(function(){var t,n,s,o,e=document.getElementById("java-runner-1752020650615237800");if(!e)return;s=e.querySelector("form"),t=e.querySelector(".export-result"),o=s.querySelector(".export-endpoint-var").value,n=e.querySelector(".java-error-tooltip"),e.querySelectorAll(".export-file-block").forEach(function(e){var t,n,s=e.querySelector(".export-file-name").textContent,o=e.querySelector("textarea");s.endsWith(".java")&&(n=CodeMirror.fromTextArea(o,{mode:"text/x-java",theme:"eclipse",lineNumbers:!0,indentUnit:4,tabSize:4}),e._cm=n,e._javaErrorLines={},n.on("cursorActivity",function(){var s,o,t=e.querySelector(".java-error-status-bar");if(!t)return;s=n.getCursor(),o=e._javaErrorLines&&e._javaErrorLines[s.line],o?(t.textContent="Ligne "+(s.line+1)+" : "+o,t.style.visibility="visible"):(t.textContent="",t.style.visibility="hidden")})),s.endsWith(".java")&&(e.querySelector(".java-error-status-bar")||(t=document.createElement("div"),t.className="java-error-status-bar",t.style.marginTop="4px",t.style.fontSize="0.95em",t.style.color="#c00",t.style.minHeight="1.2em",t.style.visibility="hidden",e.appendChild(t)))});function i(e,t,s){n.textContent=e,n.style.display="block",n.style.left=t+10+"px",n.style.top=s+10+"px"}function a(){n.style.display="none"}s.onsubmit=function(n){n.preventDefault();var s,i,a,r,c=[],l=[];e.querySelectorAll(".export-file-block").forEach(function(e){var t=e.querySelector(".export-file-name").textContent,s=e.querySelector("textarea"),n=e._cm?e._cm.getValue():s.value;t.endsWith(".java")?c.push({name:t,content:n}):l.push({name:t,content:n})}),s=0,t.textContent="Exécution en cours",i=setInterval(function(){s=(s+1)%4,t.textContent="Exécution en cours"+".".repeat(s)},500),a=new AbortController,r=setTimeout(function(){a.abort()},3e4),fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({java_files:c,txt_files:l}),signal:a.signal}).then(function(e){if(clearInterval(i),clearTimeout(r),!e.ok&&e.status!==400)throw new Error("Erreur HTTP "+e.status+" : "+e.statusText);return e.text()}).then(function(n){try{if(s=JSON.parse(n),s.status==="ran_successfully"?t.innerHTML='<pre style="color:#222;background:#e0ffe0;padding:12px;border-radius:6px;">'+(s.output||"").replace(/\n/g,"<br>")+"</pre>":s.status==="compiling"?t.innerHTML='<pre style="color:#c00;background:#ffe0e0;padding:12px;border-radius:6px;">'+(s.error||"").replace(/\n/g,"<br>")+"</pre>":s.status==="runtime_error"?t.innerHTML='<pre style="color:#c00;background:#ffe0e0;padding:12px;border-radius:6px;">'+(s.error||"").replace(/\n/g,"<br>")+"</pre>":t.textContent=n,s.status==="compiling"){for(c=s.error||"",l=new RegExp(`([\\w./\\-]+\\.java):(\\d+): error: ([^\\n]+)([\\s\\S]*?)(?=\\n[\\w./\\-]+\\.java:|$)`,"g"),e.querySelectorAll(".export-file-block").forEach(function(e){e._cm&&e._cm.operation(function(){for(var n=e._cm.getAllMarks(),t=0;t<n.length;t++)n[t].clear()}),e._javaErrorLines={};var t=e.querySelector(".java-error-status-bar");t&&(t.textContent="",t.style.visibility="hidden")});(o=l.exec(c))!==null;){var s,o,c,l,a=o[1],u=o[2],h=o[3],d=o[4],i=parseInt(u,10)-1,r=(h+(d?d.replace(/\s+/g," "):"")).trim();e.querySelectorAll(".export-file-block").forEach(function(e){var t=e.querySelector(".export-file-name");t&&(t.textContent.trim()===a||t.textContent.trim().endsWith("/"+a)||t.textContent.trim().endsWith("\\"+a))&&(e._cm&&e._cm.operation(function(){e._cm.markText({line:i,ch:0},{line:i+1,ch:0},{className:"cm-java-error",title:r})}),e._javaErrorLines||(e._javaErrorLines={}),e._javaErrorLines[i]=r)})}e.querySelectorAll(".export-file-block").forEach(function(e){if(e._cm&&e._cm.getOption("lineNumbers")){var n,s,t=e.querySelector(".java-error-status-bar");t&&(n=e._cm.getCursor(),s=e._javaErrorLines&&e._javaErrorLines[n.line],s?(t.textContent="Ligne "+(n.line+1)+" : "+s,t.style.visibility="visible"):(t.textContent="",t.style.visibility="hidden"))}})}else e.querySelectorAll(".export-file-block").forEach(function(e){e._cm&&e._cm.operation(function(){for(var n=e._cm.getAllMarks(),t=0;t<n.length;t++)n[t].clear()}),e._javaErrorLines={};var t=e.querySelector(".java-error-status-bar");t&&(t.textContent="",t.style.visibility="hidden")})}catch(e){console.log(e),t.textContent=n}}).catch(function(e){clearInterval(i),clearTimeout(r),e.name==="AbortError"?t.textContent="Erreur : délai d’attente dépassé (30 secondes).":t.textContent="Erreur lors de la requête : "+e})},e.querySelectorAll(".export-file-block").forEach(function(e){var t=e._cm;if(!t)return;t.on("mouseover",function(t,n){var a,o=t.coordsChar({left:n.clientX,top:n.clientY}),s=o.line,c=o.ch,r=t.getCursor();s===r.line&&e._javaErrorLines&&e._javaErrorLines[s]&&(a=e._javaErrorLines[s],i(a,n.clientX,n.clientY))}),t.on("mouseout",function(){a()})})})()</script></div></div><h2 id=path-et-files>Path et Files
<a class=anchor href=#path-et-files>#</a></h2><p>La lecture de fichiers en Java est une tâche courante qui a évolué avec les versions modernes du langage, notamment à partir de Java 7 avec l’introduction de l’API java.nio.file. Cette API, plus robuste et flexible que l’ancienne java.io, simplifie la gestion des fichiers et des répertoires. À partir de Java 21, les développeurs bénéficient d’une syntaxe encore plus concise grâce aux flux (Stream) et aux améliorations des performances, tout en conservant une gestion efficace des erreurs.</p><p>Un concept clé ici est l’utilisation de Path et Files. Un objet Path, créé via Path.of, représente un chemin dans le système de fichiers de manière portable, compatible avec différents systèmes d’exploitation. La classe Files, quant à elle, propose des méthodes statiques pour manipuler les fichiers, comme Files.lines, qui lit un fichier sous forme de flux de lignes. Ce flux permet de traiter les données de manière fonctionnelle, en utilisant des lambdas pour des opérations comme le filtrage ou la transformation.</p><div class=java-inline><div id=java-runner-1752020650615291661><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/eclipse.min.css><style>#java-runner-1752020650615291661 .export-form textarea{width:100%;min-height:120px;font-family:monospace;border-radius:4px;border:1px solid #ccc}#java-runner-1752020650615291661 .export-form{margin-bottom:0}#java-runner-1752020650615291661 .export-result{background:#222;color:#eee;padding:12px;border-radius:6px;margin-top:16px;white-space:pre-wrap;font-family:monospace}#java-runner-1752020650615291661 .export-endpoint-info{color:#1976d2;font-size:.98em;margin-top:8px}#java-runner-1752020650615291661 .export-btn{background:#1976d2;color:#fff;border:none;border-radius:4px;padding:8px 16px;font-size:1em;cursor:pointer;margin-top:8px}#java-runner-1752020650615291661 .export-file-block{max-width:100%;flex:1 1 350px;background:#f9f9f9;border:1px solid #ddd;border-radius:6px;padding:12px;margin-bottom:8px}#java-runner-1752020650615291661 .export-file-block .export-file-name{font-weight:700;margin-bottom:4px}.cm-java-error{background:#ffe0e0 !important;border-bottom:2px dotted #c00;cursor:pointer}.cm-java-error-line{background:#fff0f0 !important}</style><form class="export-form java-runner-1752020650615291661-form" style=margin-bottom:0><input type=hidden class=export-endpoint-var value=https://flask-service-inf1220-java.90qakjuvfj4f8.ca-central-1.cs.amazonlightsail.com/run><div style=display:flex;gap:12px;flex-wrap:wrap><div class=export-file-block><div class=export-file-name>Main.java</div><textarea>
import java.nio.file.Files;
import java.nio.file.Path;
import java.io.IOException;

void main() {
  try {
    Path chemin = Path.of(&#34;Main.java&#34;);
    Files.lines(chemin)
          .forEach(ligne -&gt; System.out.println(&#34;Lue : &#34; &#43; ligne));
  } catch (IOException e) {
    System.out.println(&#34;Erreur de lecture : &#34; &#43; e.getMessage());
  }
}

</textarea></div></div><button type=submit class="export-btn java-runner-1752020650615291661-btn" style="background:#1976d2;color:#fff;border:none;border-radius:4px;padding:8px 16px;font-size:1em;cursor:pointer;margin-top:8px">Exécuter</button></form><div class=export-result></div><div class=java-error-tooltip style="display:none;position:absolute;z-index:1000;background:#fff0f0;color:#c00;border:1px solid #c00;padding:6px 12px;border-radius:6px;font-size:1em;box-shadow:0 2px 8px #0002"></div><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/clike/clike.min.js></script><script>(function(){var t,n,s,o,e=document.getElementById("java-runner-1752020650615291661");if(!e)return;s=e.querySelector("form"),t=e.querySelector(".export-result"),o=s.querySelector(".export-endpoint-var").value,n=e.querySelector(".java-error-tooltip"),e.querySelectorAll(".export-file-block").forEach(function(e){var t,n,s=e.querySelector(".export-file-name").textContent,o=e.querySelector("textarea");s.endsWith(".java")&&(n=CodeMirror.fromTextArea(o,{mode:"text/x-java",theme:"eclipse",lineNumbers:!0,indentUnit:4,tabSize:4}),e._cm=n,e._javaErrorLines={},n.on("cursorActivity",function(){var s,o,t=e.querySelector(".java-error-status-bar");if(!t)return;s=n.getCursor(),o=e._javaErrorLines&&e._javaErrorLines[s.line],o?(t.textContent="Ligne "+(s.line+1)+" : "+o,t.style.visibility="visible"):(t.textContent="",t.style.visibility="hidden")})),s.endsWith(".java")&&(e.querySelector(".java-error-status-bar")||(t=document.createElement("div"),t.className="java-error-status-bar",t.style.marginTop="4px",t.style.fontSize="0.95em",t.style.color="#c00",t.style.minHeight="1.2em",t.style.visibility="hidden",e.appendChild(t)))});function i(e,t,s){n.textContent=e,n.style.display="block",n.style.left=t+10+"px",n.style.top=s+10+"px"}function a(){n.style.display="none"}s.onsubmit=function(n){n.preventDefault();var s,i,a,r,c=[],l=[];e.querySelectorAll(".export-file-block").forEach(function(e){var t=e.querySelector(".export-file-name").textContent,s=e.querySelector("textarea"),n=e._cm?e._cm.getValue():s.value;t.endsWith(".java")?c.push({name:t,content:n}):l.push({name:t,content:n})}),s=0,t.textContent="Exécution en cours",i=setInterval(function(){s=(s+1)%4,t.textContent="Exécution en cours"+".".repeat(s)},500),a=new AbortController,r=setTimeout(function(){a.abort()},3e4),fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({java_files:c,txt_files:l}),signal:a.signal}).then(function(e){if(clearInterval(i),clearTimeout(r),!e.ok&&e.status!==400)throw new Error("Erreur HTTP "+e.status+" : "+e.statusText);return e.text()}).then(function(n){try{if(s=JSON.parse(n),s.status==="ran_successfully"?t.innerHTML='<pre style="color:#222;background:#e0ffe0;padding:12px;border-radius:6px;">'+(s.output||"").replace(/\n/g,"<br>")+"</pre>":s.status==="compiling"?t.innerHTML='<pre style="color:#c00;background:#ffe0e0;padding:12px;border-radius:6px;">'+(s.error||"").replace(/\n/g,"<br>")+"</pre>":s.status==="runtime_error"?t.innerHTML='<pre style="color:#c00;background:#ffe0e0;padding:12px;border-radius:6px;">'+(s.error||"").replace(/\n/g,"<br>")+"</pre>":t.textContent=n,s.status==="compiling"){for(c=s.error||"",l=new RegExp(`([\\w./\\-]+\\.java):(\\d+): error: ([^\\n]+)([\\s\\S]*?)(?=\\n[\\w./\\-]+\\.java:|$)`,"g"),e.querySelectorAll(".export-file-block").forEach(function(e){e._cm&&e._cm.operation(function(){for(var n=e._cm.getAllMarks(),t=0;t<n.length;t++)n[t].clear()}),e._javaErrorLines={};var t=e.querySelector(".java-error-status-bar");t&&(t.textContent="",t.style.visibility="hidden")});(o=l.exec(c))!==null;){var s,o,c,l,a=o[1],u=o[2],h=o[3],d=o[4],i=parseInt(u,10)-1,r=(h+(d?d.replace(/\s+/g," "):"")).trim();e.querySelectorAll(".export-file-block").forEach(function(e){var t=e.querySelector(".export-file-name");t&&(t.textContent.trim()===a||t.textContent.trim().endsWith("/"+a)||t.textContent.trim().endsWith("\\"+a))&&(e._cm&&e._cm.operation(function(){e._cm.markText({line:i,ch:0},{line:i+1,ch:0},{className:"cm-java-error",title:r})}),e._javaErrorLines||(e._javaErrorLines={}),e._javaErrorLines[i]=r)})}e.querySelectorAll(".export-file-block").forEach(function(e){if(e._cm&&e._cm.getOption("lineNumbers")){var n,s,t=e.querySelector(".java-error-status-bar");t&&(n=e._cm.getCursor(),s=e._javaErrorLines&&e._javaErrorLines[n.line],s?(t.textContent="Ligne "+(n.line+1)+" : "+s,t.style.visibility="visible"):(t.textContent="",t.style.visibility="hidden"))}})}else e.querySelectorAll(".export-file-block").forEach(function(e){e._cm&&e._cm.operation(function(){for(var n=e._cm.getAllMarks(),t=0;t<n.length;t++)n[t].clear()}),e._javaErrorLines={};var t=e.querySelector(".java-error-status-bar");t&&(t.textContent="",t.style.visibility="hidden")})}catch(e){console.log(e),t.textContent=n}}).catch(function(e){clearInterval(i),clearTimeout(r),e.name==="AbortError"?t.textContent="Erreur : délai d’attente dépassé (30 secondes).":t.textContent="Erreur lors de la requête : "+e})},e.querySelectorAll(".export-file-block").forEach(function(e){var t=e._cm;if(!t)return;t.on("mouseover",function(t,n){var a,o=t.coordsChar({left:n.clientX,top:n.clientY}),s=o.line,c=o.ch,r=t.getCursor();s===r.line&&e._javaErrorLines&&e._javaErrorLines[s]&&(a=e._javaErrorLines[s],i(a,n.clientX,n.clientY))}),t.on("mouseout",function(){a()})})})()</script></div></div><p>Dans cet exemple, le programme lit le contenu d’un fichier config.txt en une seule chaîne avec Files.readString. L’objet Path est créé pour désigner le fichier, et la méthode Files.readString récupère son contenu directement, éliminant le besoin de boucler sur les lignes. Comme dans l’exemple précédent, une gestion d’exceptions via un bloc try-catch capture les erreurs potentielles, telles qu’un fichier introuvable ou des problèmes d’accès, assurant la robustesse du programme.</p><h2 id=fichiers-properties>Fichiers <em>properties</em>
<a class=anchor href=#fichiers-properties>#</a></h2><p>Le format de fichiers properties est un format de configuration simple et léger, nativement pris en charge par Java via la classe java.util.Properties. Il stocke des données sous forme de paires clé-valeur, où chaque ligne suit la syntaxe clé=valeur ou clé:valeur, avec la possibilité d’ajouter des commentaires commençant par # ou !.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-properties data-lang=properties><span style=display:flex><span><span style=color:#57606a># Configuration de l&#39;application</span>
</span></span><span style=display:flex><span><span style=color:#57606a># Date de dernière mise à jour : 28 juin 2025</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#57606a># Paramètres de connexion à la base de données</span>
</span></span><span style=display:flex><span><span style=color:#1f2328>db.host</span><span style=color:#0550ae>=</span><span style=color:#0a3069>localhost</span>
</span></span><span style=display:flex><span><span style=color:#1f2328>db.port</span><span style=color:#0550ae>=</span><span style=color:#0a3069>3306</span>
</span></span><span style=display:flex><span><span style=color:#1f2328>db.name</span><span style=color:#0550ae>=</span><span style=color:#0a3069>mabase</span>
</span></span><span style=display:flex><span><span style=color:#1f2328>db.user</span><span style=color:#0550ae>=</span><span style=color:#0a3069>admin</span>
</span></span><span style=display:flex><span><span style=color:#1f2328>db.password</span><span style=color:#0550ae>=</span><span style=color:#0a3069>secret</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#57606a># Paramètres du serveur</span>
</span></span><span style=display:flex><span><span style=color:#1f2328>server.url</span><span style=color:#0550ae>=</span><span style=color:#0a3069>https://monapp.com</span>
</span></span><span style=display:flex><span><span style=color:#1f2328>server.port</span><span style=color:#0550ae>=</span><span style=color:#0a3069>8080</span>
</span></span><span style=display:flex><span><span style=color:#1f2328>server.timeout</span><span style=color:#0550ae>=</span><span style=color:#0a3069>30</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#57606a># Autres configurations</span>
</span></span><span style=display:flex><span><span style=color:#1f2328>app.version</span><span style=color:#0550ae>=</span><span style=color:#0a3069>1.0.0</span>
</span></span><span style=display:flex><span><span style=color:#1f2328>app.debug</span><span style=color:#0550ae>=</span><span style=color:#0a3069>false</span>
</span></span><span style=display:flex><span><span style=color:#1f2328>app.language</span><span style=color:#0550ae>=</span><span style=color:#0a3069>fr</span>
</span></span></code></pre></div><p>Ce programme illustre la création, la sauvegarde, et le chargement d&rsquo;un tel fichier. Il exécute trois étapes : d’abord, il crée un fichier config.properties avec des paires clé-valeur initiales (comme application.nom=MonApp) en utilisant Files.writeString pour écrire le contenu généré par Properties.store. Ensuite, il lit ce fichier avec Files.readString, charge les propriétés dans un objet Properties, et affiche les paires clé-valeur. Enfin, il modifie les propriétés en ajoutant une nouvelle clé (nouveau.param) et en mettant à jour une existante (serveur.port), puis réécrit le fichier. Entre chaque étape, le programme lit et affiche le contenu brut du fichier pour montrer son état.</p><div class=java-inline><div id=java-runner-1752020650615405436><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/eclipse.min.css><style>#java-runner-1752020650615405436 .export-form textarea{width:100%;min-height:120px;font-family:monospace;border-radius:4px;border:1px solid #ccc}#java-runner-1752020650615405436 .export-form{margin-bottom:0}#java-runner-1752020650615405436 .export-result{background:#222;color:#eee;padding:12px;border-radius:6px;margin-top:16px;white-space:pre-wrap;font-family:monospace}#java-runner-1752020650615405436 .export-endpoint-info{color:#1976d2;font-size:.98em;margin-top:8px}#java-runner-1752020650615405436 .export-btn{background:#1976d2;color:#fff;border:none;border-radius:4px;padding:8px 16px;font-size:1em;cursor:pointer;margin-top:8px}#java-runner-1752020650615405436 .export-file-block{max-width:100%;flex:1 1 350px;background:#f9f9f9;border:1px solid #ddd;border-radius:6px;padding:12px;margin-bottom:8px}#java-runner-1752020650615405436 .export-file-block .export-file-name{font-weight:700;margin-bottom:4px}.cm-java-error{background:#ffe0e0 !important;border-bottom:2px dotted #c00;cursor:pointer}.cm-java-error-line{background:#fff0f0 !important}</style><form class="export-form java-runner-1752020650615405436-form" style=margin-bottom:0><input type=hidden class=export-endpoint-var value=https://flask-service-inf1220-java.90qakjuvfj4f8.ca-central-1.cs.amazonlightsail.com/run><div style=display:flex;gap:12px;flex-wrap:wrap><div class=export-file-block><div class=export-file-name>PropertiesReadWriteExample.java</div><textarea>

import java.nio.file.Files;
import java.nio.file.Path;
import java.io.IOException;
import java.util.Properties;
import java.io.StringReader;
import java.io.StringWriter;

public class PropertiesReadWriteExample {
    public static void main(String[] args) {
        Path chemin = Path.of(&#34;config.properties&#34;);
        Properties props = new Properties();

        // Étape 1 : Création initiale du fichier properties
        try {
            props.setProperty(&#34;application.nom&#34;, &#34;MonApp&#34;);
            props.setProperty(&#34;application.version&#34;, &#34;1.0.0&#34;);
            props.setProperty(&#34;serveur.port&#34;, &#34;8080&#34;);
            props.setProperty(&#34;serveur.hôte&#34;, &#34;localhost&#34;);
            StringWriter writer = new StringWriter();
            props.store(writer, &#34;Configuration initiale&#34;);
            String contenuInitial = writer.toString();
            Files.writeString(chemin, contenuInitial);
            System.out.println(&#34;Fichier créé avec succès : &#34; &#43; chemin.toAbsolutePath());
        } catch (IOException e) {
            System.err.println(&#34;Erreur lors de la création du fichier : &#34; &#43; e.getMessage());
            return;
        }

        // Lecture et affichage du contenu après création
        try {
            String contenu = Files.readString(chemin);
            System.out.println(&#34;\nContenu brut du fichier après création :\n&#34; &#43; contenu);
        } catch (IOException e) {
            System.err.println(&#34;Erreur lors de la lecture post-création : &#34; &#43; e.getMessage());
            return;
        }

        // Étape 2 : Lecture du fichier
        try {
            String contenu = Files.readString(chemin);
            props.clear();
            props.load(new StringReader(contenu));
            System.out.println(&#34;\nContenu du fichier après lecture (paires clé-valeur) :&#34;);
            props.forEach((clé, valeur) -&gt; System.out.println(clé &#43; &#34;: &#34; &#43; valeur));
        } catch (IOException e) {
            System.err.println(&#34;Erreur lors de la lecture : &#34; &#43; e.getMessage());
            return;
        }

        // Lecture et affichage du contenu avant modification
        try {
            String contenu = Files.readString(chemin);
            System.out.println(&#34;\nContenu brut du fichier avant modification :\n&#34; &#43; contenu);
        } catch (IOException e) {
            System.err.println(&#34;Erreur lors de la lecture pré-modification : &#34; &#43; e.getMessage());
            return;
        }

        // Étape 3 : Modification et réécriture
        try {
            props.setProperty(&#34;nouveau.param&#34;, &#34;valeurAjoutée&#34;);
            props.setProperty(&#34;serveur.port&#34;, &#34;9090&#34;);
            StringWriter writer = new StringWriter();
            props.store(writer, &#34;Configuration mise à jour&#34;);
            String nouveauContenu = writer.toString();
            Files.writeString(chemin, nouveauContenu);
            System.out.println(&#34;\nFichier modifié avec succès : &#34; &#43; chemin.toAbsolutePath());
        } catch (IOException e) {
            System.err.println(&#34;Erreur lors de la modification : &#34; &#43; e.getMessage());
            return;
        }

        // Lecture et affichage du contenu après modification
        try {
            String contenu = Files.readString(chemin);
            System.out.println(&#34;\nContenu brut du fichier après modification :\n&#34; &#43; contenu);
        } catch (IOException e) {
            System.err.println(&#34;Erreur lors de la lecture post-modification : &#34; &#43; e.getMessage());
        }
    }
}
</textarea></div></div><button type=submit class="export-btn java-runner-1752020650615405436-btn" style="background:#1976d2;color:#fff;border:none;border-radius:4px;padding:8px 16px;font-size:1em;cursor:pointer;margin-top:8px">Exécuter</button></form><div class=export-result></div><div class=java-error-tooltip style="display:none;position:absolute;z-index:1000;background:#fff0f0;color:#c00;border:1px solid #c00;padding:6px 12px;border-radius:6px;font-size:1em;box-shadow:0 2px 8px #0002"></div><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/clike/clike.min.js></script><script>(function(){var t,n,s,o,e=document.getElementById("java-runner-1752020650615405436");if(!e)return;s=e.querySelector("form"),t=e.querySelector(".export-result"),o=s.querySelector(".export-endpoint-var").value,n=e.querySelector(".java-error-tooltip"),e.querySelectorAll(".export-file-block").forEach(function(e){var t,n,s=e.querySelector(".export-file-name").textContent,o=e.querySelector("textarea");s.endsWith(".java")&&(n=CodeMirror.fromTextArea(o,{mode:"text/x-java",theme:"eclipse",lineNumbers:!0,indentUnit:4,tabSize:4}),e._cm=n,e._javaErrorLines={},n.on("cursorActivity",function(){var s,o,t=e.querySelector(".java-error-status-bar");if(!t)return;s=n.getCursor(),o=e._javaErrorLines&&e._javaErrorLines[s.line],o?(t.textContent="Ligne "+(s.line+1)+" : "+o,t.style.visibility="visible"):(t.textContent="",t.style.visibility="hidden")})),s.endsWith(".java")&&(e.querySelector(".java-error-status-bar")||(t=document.createElement("div"),t.className="java-error-status-bar",t.style.marginTop="4px",t.style.fontSize="0.95em",t.style.color="#c00",t.style.minHeight="1.2em",t.style.visibility="hidden",e.appendChild(t)))});function i(e,t,s){n.textContent=e,n.style.display="block",n.style.left=t+10+"px",n.style.top=s+10+"px"}function a(){n.style.display="none"}s.onsubmit=function(n){n.preventDefault();var s,i,a,r,c=[],l=[];e.querySelectorAll(".export-file-block").forEach(function(e){var t=e.querySelector(".export-file-name").textContent,s=e.querySelector("textarea"),n=e._cm?e._cm.getValue():s.value;t.endsWith(".java")?c.push({name:t,content:n}):l.push({name:t,content:n})}),s=0,t.textContent="Exécution en cours",i=setInterval(function(){s=(s+1)%4,t.textContent="Exécution en cours"+".".repeat(s)},500),a=new AbortController,r=setTimeout(function(){a.abort()},3e4),fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({java_files:c,txt_files:l}),signal:a.signal}).then(function(e){if(clearInterval(i),clearTimeout(r),!e.ok&&e.status!==400)throw new Error("Erreur HTTP "+e.status+" : "+e.statusText);return e.text()}).then(function(n){try{if(s=JSON.parse(n),s.status==="ran_successfully"?t.innerHTML='<pre style="color:#222;background:#e0ffe0;padding:12px;border-radius:6px;">'+(s.output||"").replace(/\n/g,"<br>")+"</pre>":s.status==="compiling"?t.innerHTML='<pre style="color:#c00;background:#ffe0e0;padding:12px;border-radius:6px;">'+(s.error||"").replace(/\n/g,"<br>")+"</pre>":s.status==="runtime_error"?t.innerHTML='<pre style="color:#c00;background:#ffe0e0;padding:12px;border-radius:6px;">'+(s.error||"").replace(/\n/g,"<br>")+"</pre>":t.textContent=n,s.status==="compiling"){for(c=s.error||"",l=new RegExp(`([\\w./\\-]+\\.java):(\\d+): error: ([^\\n]+)([\\s\\S]*?)(?=\\n[\\w./\\-]+\\.java:|$)`,"g"),e.querySelectorAll(".export-file-block").forEach(function(e){e._cm&&e._cm.operation(function(){for(var n=e._cm.getAllMarks(),t=0;t<n.length;t++)n[t].clear()}),e._javaErrorLines={};var t=e.querySelector(".java-error-status-bar");t&&(t.textContent="",t.style.visibility="hidden")});(o=l.exec(c))!==null;){var s,o,c,l,a=o[1],u=o[2],h=o[3],d=o[4],i=parseInt(u,10)-1,r=(h+(d?d.replace(/\s+/g," "):"")).trim();e.querySelectorAll(".export-file-block").forEach(function(e){var t=e.querySelector(".export-file-name");t&&(t.textContent.trim()===a||t.textContent.trim().endsWith("/"+a)||t.textContent.trim().endsWith("\\"+a))&&(e._cm&&e._cm.operation(function(){e._cm.markText({line:i,ch:0},{line:i+1,ch:0},{className:"cm-java-error",title:r})}),e._javaErrorLines||(e._javaErrorLines={}),e._javaErrorLines[i]=r)})}e.querySelectorAll(".export-file-block").forEach(function(e){if(e._cm&&e._cm.getOption("lineNumbers")){var n,s,t=e.querySelector(".java-error-status-bar");t&&(n=e._cm.getCursor(),s=e._javaErrorLines&&e._javaErrorLines[n.line],s?(t.textContent="Ligne "+(n.line+1)+" : "+s,t.style.visibility="visible"):(t.textContent="",t.style.visibility="hidden"))}})}else e.querySelectorAll(".export-file-block").forEach(function(e){e._cm&&e._cm.operation(function(){for(var n=e._cm.getAllMarks(),t=0;t<n.length;t++)n[t].clear()}),e._javaErrorLines={};var t=e.querySelector(".java-error-status-bar");t&&(t.textContent="",t.style.visibility="hidden")})}catch(e){console.log(e),t.textContent=n}}).catch(function(e){clearInterval(i),clearTimeout(r),e.name==="AbortError"?t.textContent="Erreur : délai d’attente dépassé (30 secondes).":t.textContent="Erreur lors de la requête : "+e})},e.querySelectorAll(".export-file-block").forEach(function(e){var t=e._cm;if(!t)return;t.on("mouseover",function(t,n){var a,o=t.coordsChar({left:n.clientX,top:n.clientY}),s=o.line,c=o.ch,r=t.getCursor();s===r.line&&e._javaErrorLines&&e._javaErrorLines[s]&&(a=e._javaErrorLines[s],i(a,n.clientX,n.clientY))}),t.on("mouseout",function(){a()})})})()</script></div></div><h2 id=utf-8>UTF-8
<a class=anchor href=#utf-8>#</a></h2><p>Depuis Java 11, les accès texte aux fichiers, via des classes comme Files.readString ou Files.writeString de l’API java.nio.file, utilisent par défaut l’encodage UTF-8, remplaçant l’encodage par défaut de la plateforme. UTF-8 est un encodage de longueur variable qui représente les caractères Unicode, utilisant un à quatre octets par caractère : les caractères ASCII (0 à 127) sont codés sur un seul octet, tandis que les caractères non-ASCII, comme les accents ou les idéogrammes, nécessitent plus d’octets. En revanche, les chaînes de caractères en Java sont stockées en mémoire en UTF-16, où chaque caractère occupe généralement deux octets, même pour les caractères ASCII. Lorsqu’un fichier texte contenant uniquement des caractères ASCII est enregistré en UTF-8 avec Files.writeString, chaque caractère est écrit sur un octet, produisant un fichier plus compact. Par exemple, la chaîne &ldquo;Bonjour&rdquo; (7 caractères ASCII) génère un fichier de 7 octets en UTF-8, contre 14 octets si elle était enregistrée en UTF-16, où chaque caractère utilise deux octets. Cette différence illustre l’efficacité de l’UTF-8 pour les textes ASCII tout en assurant la compatibilité avec l’Unicode, contrairement à l’UTF-16 utilisé en interne par Java. Voici un exemple pour illustrer ce concept.</p><div class=java-inline><div id=java-runner-1752020650615476309><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/eclipse.min.css><style>#java-runner-1752020650615476309 .export-form textarea{width:100%;min-height:120px;font-family:monospace;border-radius:4px;border:1px solid #ccc}#java-runner-1752020650615476309 .export-form{margin-bottom:0}#java-runner-1752020650615476309 .export-result{background:#222;color:#eee;padding:12px;border-radius:6px;margin-top:16px;white-space:pre-wrap;font-family:monospace}#java-runner-1752020650615476309 .export-endpoint-info{color:#1976d2;font-size:.98em;margin-top:8px}#java-runner-1752020650615476309 .export-btn{background:#1976d2;color:#fff;border:none;border-radius:4px;padding:8px 16px;font-size:1em;cursor:pointer;margin-top:8px}#java-runner-1752020650615476309 .export-file-block{max-width:100%;flex:1 1 350px;background:#f9f9f9;border:1px solid #ddd;border-radius:6px;padding:12px;margin-bottom:8px}#java-runner-1752020650615476309 .export-file-block .export-file-name{font-weight:700;margin-bottom:4px}.cm-java-error{background:#ffe0e0 !important;border-bottom:2px dotted #c00;cursor:pointer}.cm-java-error-line{background:#fff0f0 !important}</style><form class="export-form java-runner-1752020650615476309-form" style=margin-bottom:0><input type=hidden class=export-endpoint-var value=https://flask-service-inf1220-java.90qakjuvfj4f8.ca-central-1.cs.amazonlightsail.com/run><div style=display:flex;gap:12px;flex-wrap:wrap><div class=export-file-block><div class=export-file-name>EncodageFichierTexte.java</div><textarea>
import java.nio.file.Files;
import java.nio.file.Path;
import java.io.IOException;
import java.nio.charset.StandardCharsets;

public class EncodageFichierTexte {
    public static void main(String[] args) {
        String texteAscii = &#34;Bonjour&#34;;
        String fichierUtf8 = &#34;texte_utf8.txt&#34;;
        String fichierUtf16 = &#34;texte_utf16.txt&#34;;
        
        // Écriture en UTF-8
        try {
            Files.writeString(Path.of(fichierUtf8), texteAscii, StandardCharsets.UTF_8);
            long tailleUtf8 = Files.size(Path.of(fichierUtf8));
            System.out.println(&#34;Taille du fichier UTF-8 (&#34; &#43; fichierUtf8 &#43; &#34;) : &#34; &#43; tailleUtf8 &#43; &#34; octets&#34;);
        } catch (IOException e) {
            System.err.println(&#34;Erreur lors de l’écriture en UTF-8 : &#34; &#43; e.getMessage());
        }
        
        // Écriture en UTF-16
        try {
            Files.writeString(Path.of(fichierUtf16), texteAscii, StandardCharsets.UTF_16);
            long tailleUtf16 = Files.size(Path.of(fichierUtf16));
            System.out.println(&#34;Taille du fichier UTF-16 (&#34; &#43; fichierUtf16 &#43; &#34;) : &#34; &#43; tailleUtf16 &#43; &#34; octets&#34;);
        } catch (IOException e) {
            System.err.println(&#34;Erreur lors de l’écriture en UTF-16 : &#34; &#43; e.getMessage());
        }
        
        // Vérification du contenu en lisant le fichier UTF-8
        try {
            String contenuUtf8 = Files.readString(Path.of(fichierUtf8), StandardCharsets.UTF_8);
            System.out.println(&#34;Contenu lu depuis le fichier UTF-8 : &#34; &#43; contenuUtf8);
        } catch (IOException e) {
            System.err.println(&#34;Erreur lors de la lecture du fichier UTF-8 : &#34; &#43; e.getMessage());
        }
        
        // Vérification du contenu en lisant le fichier UTF-16
        try {
            String contenuUtf16 = Files.readString(Path.of(fichierUtf16), StandardCharsets.UTF_16);
            System.out.println(&#34;Contenu lu depuis le fichier UTF-16 : &#34; &#43; contenuUtf16);
        } catch (IOException e) {
            System.err.println(&#34;Erreur lors de la lecture du fichier UTF-16 : &#34; &#43; e.getMessage());
        }
    }
}
</textarea></div></div><button type=submit class="export-btn java-runner-1752020650615476309-btn" style="background:#1976d2;color:#fff;border:none;border-radius:4px;padding:8px 16px;font-size:1em;cursor:pointer;margin-top:8px">Exécuter</button></form><div class=export-result></div><div class=java-error-tooltip style="display:none;position:absolute;z-index:1000;background:#fff0f0;color:#c00;border:1px solid #c00;padding:6px 12px;border-radius:6px;font-size:1em;box-shadow:0 2px 8px #0002"></div><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/clike/clike.min.js></script><script>(function(){var t,n,s,o,e=document.getElementById("java-runner-1752020650615476309");if(!e)return;s=e.querySelector("form"),t=e.querySelector(".export-result"),o=s.querySelector(".export-endpoint-var").value,n=e.querySelector(".java-error-tooltip"),e.querySelectorAll(".export-file-block").forEach(function(e){var t,n,s=e.querySelector(".export-file-name").textContent,o=e.querySelector("textarea");s.endsWith(".java")&&(n=CodeMirror.fromTextArea(o,{mode:"text/x-java",theme:"eclipse",lineNumbers:!0,indentUnit:4,tabSize:4}),e._cm=n,e._javaErrorLines={},n.on("cursorActivity",function(){var s,o,t=e.querySelector(".java-error-status-bar");if(!t)return;s=n.getCursor(),o=e._javaErrorLines&&e._javaErrorLines[s.line],o?(t.textContent="Ligne "+(s.line+1)+" : "+o,t.style.visibility="visible"):(t.textContent="",t.style.visibility="hidden")})),s.endsWith(".java")&&(e.querySelector(".java-error-status-bar")||(t=document.createElement("div"),t.className="java-error-status-bar",t.style.marginTop="4px",t.style.fontSize="0.95em",t.style.color="#c00",t.style.minHeight="1.2em",t.style.visibility="hidden",e.appendChild(t)))});function i(e,t,s){n.textContent=e,n.style.display="block",n.style.left=t+10+"px",n.style.top=s+10+"px"}function a(){n.style.display="none"}s.onsubmit=function(n){n.preventDefault();var s,i,a,r,c=[],l=[];e.querySelectorAll(".export-file-block").forEach(function(e){var t=e.querySelector(".export-file-name").textContent,s=e.querySelector("textarea"),n=e._cm?e._cm.getValue():s.value;t.endsWith(".java")?c.push({name:t,content:n}):l.push({name:t,content:n})}),s=0,t.textContent="Exécution en cours",i=setInterval(function(){s=(s+1)%4,t.textContent="Exécution en cours"+".".repeat(s)},500),a=new AbortController,r=setTimeout(function(){a.abort()},3e4),fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({java_files:c,txt_files:l}),signal:a.signal}).then(function(e){if(clearInterval(i),clearTimeout(r),!e.ok&&e.status!==400)throw new Error("Erreur HTTP "+e.status+" : "+e.statusText);return e.text()}).then(function(n){try{if(s=JSON.parse(n),s.status==="ran_successfully"?t.innerHTML='<pre style="color:#222;background:#e0ffe0;padding:12px;border-radius:6px;">'+(s.output||"").replace(/\n/g,"<br>")+"</pre>":s.status==="compiling"?t.innerHTML='<pre style="color:#c00;background:#ffe0e0;padding:12px;border-radius:6px;">'+(s.error||"").replace(/\n/g,"<br>")+"</pre>":s.status==="runtime_error"?t.innerHTML='<pre style="color:#c00;background:#ffe0e0;padding:12px;border-radius:6px;">'+(s.error||"").replace(/\n/g,"<br>")+"</pre>":t.textContent=n,s.status==="compiling"){for(c=s.error||"",l=new RegExp(`([\\w./\\-]+\\.java):(\\d+): error: ([^\\n]+)([\\s\\S]*?)(?=\\n[\\w./\\-]+\\.java:|$)`,"g"),e.querySelectorAll(".export-file-block").forEach(function(e){e._cm&&e._cm.operation(function(){for(var n=e._cm.getAllMarks(),t=0;t<n.length;t++)n[t].clear()}),e._javaErrorLines={};var t=e.querySelector(".java-error-status-bar");t&&(t.textContent="",t.style.visibility="hidden")});(o=l.exec(c))!==null;){var s,o,c,l,a=o[1],u=o[2],h=o[3],d=o[4],i=parseInt(u,10)-1,r=(h+(d?d.replace(/\s+/g," "):"")).trim();e.querySelectorAll(".export-file-block").forEach(function(e){var t=e.querySelector(".export-file-name");t&&(t.textContent.trim()===a||t.textContent.trim().endsWith("/"+a)||t.textContent.trim().endsWith("\\"+a))&&(e._cm&&e._cm.operation(function(){e._cm.markText({line:i,ch:0},{line:i+1,ch:0},{className:"cm-java-error",title:r})}),e._javaErrorLines||(e._javaErrorLines={}),e._javaErrorLines[i]=r)})}e.querySelectorAll(".export-file-block").forEach(function(e){if(e._cm&&e._cm.getOption("lineNumbers")){var n,s,t=e.querySelector(".java-error-status-bar");t&&(n=e._cm.getCursor(),s=e._javaErrorLines&&e._javaErrorLines[n.line],s?(t.textContent="Ligne "+(n.line+1)+" : "+s,t.style.visibility="visible"):(t.textContent="",t.style.visibility="hidden"))}})}else e.querySelectorAll(".export-file-block").forEach(function(e){e._cm&&e._cm.operation(function(){for(var n=e._cm.getAllMarks(),t=0;t<n.length;t++)n[t].clear()}),e._javaErrorLines={};var t=e.querySelector(".java-error-status-bar");t&&(t.textContent="",t.style.visibility="hidden")})}catch(e){console.log(e),t.textContent=n}}).catch(function(e){clearInterval(i),clearTimeout(r),e.name==="AbortError"?t.textContent="Erreur : délai d’attente dépassé (30 secondes).":t.textContent="Erreur lors de la requête : "+e})},e.querySelectorAll(".export-file-block").forEach(function(e){var t=e._cm;if(!t)return;t.on("mouseover",function(t,n){var a,o=t.coordsChar({left:n.clientX,top:n.clientY}),s=o.line,c=o.ch,r=t.getCursor();s===r.line&&e._javaErrorLines&&e._javaErrorLines[s]&&(a=e._javaErrorLines[s],i(a,n.clientX,n.clientY))}),t.on("mouseout",function(){a()})})})()</script></div></div><h2 id=boutisme>Boutisme
<a class=anchor href=#boutisme>#</a></h2><p>Le boutisme, ou endianness, désigne l’ordre dans lequel les octets d’une donnée multi-octets (comme un entier) sont stockés ou lus en mémoire. Il existe deux ordres principaux : big-endian, où l’octet de poids fort est stocké en premier, et little-endian, où l’octet de poids faible est stocké en premier. Par exemple, pour l’entier 258 (représenté en hexadécimal comme <code>00 00 01 02</code>), un système big-endian stocke les octets dans l’ordre <code>00 00 01 02</code>, tandis qu’un système little-endian les stocke comme <code>02 01 00 00</code>. Ce concept est crucial lors de la manipulation de fichiers binaires ou de communications réseau, car une mauvaise interprétation de l’ordre peut produire des résultats erronés.</p><p>En Java, des classes comme <code>DataOutputStream</code> utilisent par défaut l’ordre big-endian, mais <code>ByteBuffer</code> permet de spécifier l’ordre (big-endian ou little-endian) avec <code>ByteOrder</code>. Une mauvaise gestion du boutisme peut entraîner des erreurs lors de la lecture de données produites par un système avec un ordre différent. L’exemple suivant illustre ce problème en écrivant des entiers dans un fichier binaire en big-endian et en les lisant en supposant un ordre little-endian.</p><p>Voici un programme Java qui écrit trois entiers (100, 200, 300) dans un fichier binaire en utilisant l’ordre big-endian, puis lit ce fichier en supposant un ordre little-endian.</p><div class=java-inline><div id=java-runner-1752020650615542053><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/eclipse.min.css><style>#java-runner-1752020650615542053 .export-form textarea{width:100%;min-height:120px;font-family:monospace;border-radius:4px;border:1px solid #ccc}#java-runner-1752020650615542053 .export-form{margin-bottom:0}#java-runner-1752020650615542053 .export-result{background:#222;color:#eee;padding:12px;border-radius:6px;margin-top:16px;white-space:pre-wrap;font-family:monospace}#java-runner-1752020650615542053 .export-endpoint-info{color:#1976d2;font-size:.98em;margin-top:8px}#java-runner-1752020650615542053 .export-btn{background:#1976d2;color:#fff;border:none;border-radius:4px;padding:8px 16px;font-size:1em;cursor:pointer;margin-top:8px}#java-runner-1752020650615542053 .export-file-block{max-width:100%;flex:1 1 350px;background:#f9f9f9;border:1px solid #ddd;border-radius:6px;padding:12px;margin-bottom:8px}#java-runner-1752020650615542053 .export-file-block .export-file-name{font-weight:700;margin-bottom:4px}.cm-java-error{background:#ffe0e0 !important;border-bottom:2px dotted #c00;cursor:pointer}.cm-java-error-line{background:#fff0f0 !important}</style><form class="export-form java-runner-1752020650615542053-form" style=margin-bottom:0><input type=hidden class=export-endpoint-var value=https://flask-service-inf1220-java.90qakjuvfj4f8.ca-central-1.cs.amazonlightsail.com/run><div style=display:flex;gap:12px;flex-wrap:wrap><div class=export-file-block><div class=export-file-name>ImpactBoutismeManuel.java</div><textarea>
import java.io.*;

public class ImpactBoutismeManuel {
    public static void main(String[] args) {
        String nomFichier = &#34;entiers_manuel.bin&#34;;
        
        // Écriture en big-endian
        try (DataOutputStream sortie = new DataOutputStream(new FileOutputStream(nomFichier))) {
            int[] entiers = {100, 200, 300};
            for (int valeur : entiers) {
                sortie.writeInt(valeur); // Big-endian par défaut
            }
            System.out.println(&#34;Entiers écrits (big-endian) : 100, 200, 300&#34;);
        } catch (IOException e) {
            System.err.println(&#34;Erreur lors de l’écriture : &#34; &#43; e.getMessage());
            return;
        }
        
        // Lecture en supposant little-endian avec conversion manuelle
        try (DataInputStream entree = new DataInputStream(new FileInputStream(nomFichier))) {
            System.out.println(&#34;Lecture en supposant little-endian (conversion manuelle) :&#34;);
            for (int i = 0; i &lt; 3; i&#43;&#43;) {
                byte[] octets = new byte[4];
                if (entree.read(octets) != 4) {
                    System.err.println(&#34;Erreur : données insuffisantes.&#34;);
                    return;
                }
                // Conversion manuelle : inverser les octets pour little-endian
                int valeur = ((octets[3] & 0xFF) &lt;&lt; 24) |
                             ((octets[2] & 0xFF) &lt;&lt; 16) |
                             ((octets[1] & 0xFF) &lt;&lt; 8)  |
                             (octets[0] & 0xFF);
                System.out.println(&#34;Entier lu : &#34; &#43; valeur);
            }
        } catch (IOException e) {
            System.err.println(&#34;Erreur lors de la lecture : &#34; &#43; e.getMessage());
        }
    }
}
</textarea></div></div><button type=submit class="export-btn java-runner-1752020650615542053-btn" style="background:#1976d2;color:#fff;border:none;border-radius:4px;padding:8px 16px;font-size:1em;cursor:pointer;margin-top:8px">Exécuter</button></form><div class=export-result></div><div class=java-error-tooltip style="display:none;position:absolute;z-index:1000;background:#fff0f0;color:#c00;border:1px solid #c00;padding:6px 12px;border-radius:6px;font-size:1em;box-shadow:0 2px 8px #0002"></div><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/clike/clike.min.js></script><script>(function(){var t,n,s,o,e=document.getElementById("java-runner-1752020650615542053");if(!e)return;s=e.querySelector("form"),t=e.querySelector(".export-result"),o=s.querySelector(".export-endpoint-var").value,n=e.querySelector(".java-error-tooltip"),e.querySelectorAll(".export-file-block").forEach(function(e){var t,n,s=e.querySelector(".export-file-name").textContent,o=e.querySelector("textarea");s.endsWith(".java")&&(n=CodeMirror.fromTextArea(o,{mode:"text/x-java",theme:"eclipse",lineNumbers:!0,indentUnit:4,tabSize:4}),e._cm=n,e._javaErrorLines={},n.on("cursorActivity",function(){var s,o,t=e.querySelector(".java-error-status-bar");if(!t)return;s=n.getCursor(),o=e._javaErrorLines&&e._javaErrorLines[s.line],o?(t.textContent="Ligne "+(s.line+1)+" : "+o,t.style.visibility="visible"):(t.textContent="",t.style.visibility="hidden")})),s.endsWith(".java")&&(e.querySelector(".java-error-status-bar")||(t=document.createElement("div"),t.className="java-error-status-bar",t.style.marginTop="4px",t.style.fontSize="0.95em",t.style.color="#c00",t.style.minHeight="1.2em",t.style.visibility="hidden",e.appendChild(t)))});function i(e,t,s){n.textContent=e,n.style.display="block",n.style.left=t+10+"px",n.style.top=s+10+"px"}function a(){n.style.display="none"}s.onsubmit=function(n){n.preventDefault();var s,i,a,r,c=[],l=[];e.querySelectorAll(".export-file-block").forEach(function(e){var t=e.querySelector(".export-file-name").textContent,s=e.querySelector("textarea"),n=e._cm?e._cm.getValue():s.value;t.endsWith(".java")?c.push({name:t,content:n}):l.push({name:t,content:n})}),s=0,t.textContent="Exécution en cours",i=setInterval(function(){s=(s+1)%4,t.textContent="Exécution en cours"+".".repeat(s)},500),a=new AbortController,r=setTimeout(function(){a.abort()},3e4),fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({java_files:c,txt_files:l}),signal:a.signal}).then(function(e){if(clearInterval(i),clearTimeout(r),!e.ok&&e.status!==400)throw new Error("Erreur HTTP "+e.status+" : "+e.statusText);return e.text()}).then(function(n){try{if(s=JSON.parse(n),s.status==="ran_successfully"?t.innerHTML='<pre style="color:#222;background:#e0ffe0;padding:12px;border-radius:6px;">'+(s.output||"").replace(/\n/g,"<br>")+"</pre>":s.status==="compiling"?t.innerHTML='<pre style="color:#c00;background:#ffe0e0;padding:12px;border-radius:6px;">'+(s.error||"").replace(/\n/g,"<br>")+"</pre>":s.status==="runtime_error"?t.innerHTML='<pre style="color:#c00;background:#ffe0e0;padding:12px;border-radius:6px;">'+(s.error||"").replace(/\n/g,"<br>")+"</pre>":t.textContent=n,s.status==="compiling"){for(c=s.error||"",l=new RegExp(`([\\w./\\-]+\\.java):(\\d+): error: ([^\\n]+)([\\s\\S]*?)(?=\\n[\\w./\\-]+\\.java:|$)`,"g"),e.querySelectorAll(".export-file-block").forEach(function(e){e._cm&&e._cm.operation(function(){for(var n=e._cm.getAllMarks(),t=0;t<n.length;t++)n[t].clear()}),e._javaErrorLines={};var t=e.querySelector(".java-error-status-bar");t&&(t.textContent="",t.style.visibility="hidden")});(o=l.exec(c))!==null;){var s,o,c,l,a=o[1],u=o[2],h=o[3],d=o[4],i=parseInt(u,10)-1,r=(h+(d?d.replace(/\s+/g," "):"")).trim();e.querySelectorAll(".export-file-block").forEach(function(e){var t=e.querySelector(".export-file-name");t&&(t.textContent.trim()===a||t.textContent.trim().endsWith("/"+a)||t.textContent.trim().endsWith("\\"+a))&&(e._cm&&e._cm.operation(function(){e._cm.markText({line:i,ch:0},{line:i+1,ch:0},{className:"cm-java-error",title:r})}),e._javaErrorLines||(e._javaErrorLines={}),e._javaErrorLines[i]=r)})}e.querySelectorAll(".export-file-block").forEach(function(e){if(e._cm&&e._cm.getOption("lineNumbers")){var n,s,t=e.querySelector(".java-error-status-bar");t&&(n=e._cm.getCursor(),s=e._javaErrorLines&&e._javaErrorLines[n.line],s?(t.textContent="Ligne "+(n.line+1)+" : "+s,t.style.visibility="visible"):(t.textContent="",t.style.visibility="hidden"))}})}else e.querySelectorAll(".export-file-block").forEach(function(e){e._cm&&e._cm.operation(function(){for(var n=e._cm.getAllMarks(),t=0;t<n.length;t++)n[t].clear()}),e._javaErrorLines={};var t=e.querySelector(".java-error-status-bar");t&&(t.textContent="",t.style.visibility="hidden")})}catch(e){console.log(e),t.textContent=n}}).catch(function(e){clearInterval(i),clearTimeout(r),e.name==="AbortError"?t.textContent="Erreur : délai d’attente dépassé (30 secondes).":t.textContent="Erreur lors de la requête : "+e})},e.querySelectorAll(".export-file-block").forEach(function(e){var t=e._cm;if(!t)return;t.on("mouseover",function(t,n){var a,o=t.coordsChar({left:n.clientX,top:n.clientY}),s=o.line,c=o.ch,r=t.getCursor();s===r.line&&e._javaErrorLines&&e._javaErrorLines[s]&&(a=e._javaErrorLines[s],i(a,n.clientX,n.clientY))}),t.on("mouseout",function(){a()})})})()</script></div></div><p>Ce programme illustre l’impact du boutisme sans utiliser ByteBuffer. Dans la phase d’écriture, DataOutputStream écrit les entiers 100, 200 et 300 dans un fichier binaire en big-endian. Par exemple, l’entier 100 (00 00 00 64 en hexadécimal) est stocké comme 00 00 00 64. Lors de la lecture, le programme lit chaque bloc de 4 octets avec DataInputStream et effectue une conversion manuelle pour interpréter les octets en little-endian. Pour cela, il inverse l’ordre des octets : l’octet 0 (le dernier en big-endian) devient le poids faible, et l’octet 3 (le premier) devient le poids fort. La formule ((octets[3] & 0xFF) &#171; 24) | &mldr; reconstruit l’entier en plaçant chaque octet à la bonne position. Ainsi, 00 00 00 64 est interprété comme 64 00 00 00, soit 1 677 721 600 en décimal.</p><h2 id=accès-à-linternet>Accès à l&rsquo;Internet
<a class=anchor href=#acc%c3%a8s-%c3%a0-linternet>#</a></h2><blockquote class="book-hint info"><p>Dans ce cours, vous n&rsquo;aurez pas à gérer des requêtes HTTP. Il est néanmoins nécessaire d&rsquo;être familier avec le principle.
Prenez la peine de lire et d&rsquo;exécuter les exemples suivants.</p></blockquote><p>Java permet aussi d&rsquo;avoir accès à des ressources sur le web. Grâce à ses bibliothèques modernes, comme l&rsquo;API HttpClient introduite dans Java 11, il est possible d&rsquo;effectuer des requêtes HTTP de manière simple et efficace, facilitant la récupération de données depuis des serveurs distants.
Le protocole HTTP (HyperText Transfer Protocol) est un protocole de communication utilisé pour transférer des données sur le web, permettant aux clients (comme les navigateurs) de demander des ressources à des serveurs. HTTP est un protocole sans état fonctionnant en mode client-serveur : un client envoie une requête spécifiant une méthode, une URI, des en-têtes et parfois un corps, et le serveur répond avec un code de statut, des en-têtes et un corps. Par sans état, on veut dire que les requêtes sont traitées de manière indépendante et non comme une conversation continue.</p><p>La majorité des services web utilisent le format JSON.
JSON (JavaScript Object Notation) est un format léger d’échange de données, facile à lire et à écrire pour les humains et les machines. Il est basé sur une syntaxe dérivée des objets JavaScript, mais il est utilisé par de nombreux langages de programmation. JSON est particulièrement populaire pour transmettre des données entre un serveur et une application web, notamment dans les API REST. Un document JSON est constitué de paires clé/valeur, de tableaux et d’objets imbriqués. Il ne supporte que quelques types de données : chaînes de caractères, nombres, booléens, tableaux, objets et null.</p><p><em>Exemple de structure JSON :</em></p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#1f2328>{</span>
</span></span><span style=display:flex><span>  <span style=color:#0550ae>&#34;nom&#34;</span><span style=color:#1f2328>:</span> <span style=color:#0a3069>&#34;Alice&#34;</span><span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>  <span style=color:#0550ae>&#34;age&#34;</span><span style=color:#1f2328>:</span> <span style=color:#0550ae>30</span><span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>  <span style=color:#0550ae>&#34;estEtudiant&#34;</span><span style=color:#1f2328>:</span> <span style=color:#cf222e>false</span><span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>  <span style=color:#0550ae>&#34;competences&#34;</span><span style=color:#1f2328>:</span> <span style=color:#1f2328>[</span><span style=color:#0a3069>&#34;Java&#34;</span><span style=color:#1f2328>,</span> <span style=color:#0a3069>&#34;HTML&#34;</span><span style=color:#1f2328>,</span> <span style=color:#0a3069>&#34;JavaScript&#34;</span><span style=color:#1f2328>]</span>
</span></span><span style=display:flex><span><span style=color:#1f2328>}</span>
</span></span></code></pre></div><p><em>Exemple d’utilisation en JavaScript :</em></p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#cf222e>const</span> <span style=color:#1f2328>donnees</span> <span style=color:#0550ae>=</span> <span style=color:#0a3069>&#39;{&#34;nom&#34;: &#34;Alice&#34;, &#34;age&#34;: 30}&#39;</span><span style=color:#1f2328>;</span>
</span></span><span style=display:flex><span><span style=color:#cf222e>const</span> <span style=color:#1f2328>obj</span> <span style=color:#0550ae>=</span> <span style=color:#1f2328>JSON</span><span style=color:#1f2328>.</span><span style=color:#1f2328>parse</span><span style=color:#1f2328>(</span><span style=color:#1f2328>donnees</span><span style=color:#1f2328>);</span>
</span></span><span style=display:flex><span><span style=color:#1f2328>console</span><span style=color:#1f2328>.</span><span style=color:#1f2328>log</span><span style=color:#1f2328>(</span><span style=color:#1f2328>obj</span><span style=color:#1f2328>.</span><span style=color:#1f2328>nom</span><span style=color:#1f2328>);</span> <span style=color:#57606a>// Affiche &#34;Alice&#34;
</span></span></span></code></pre></div><p>La vidéo suivante (optionnelle) explique comment les systèmes peuvent être optimisés pour traitement le JSON efficacement.</p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share; fullscreen" loading=eager referrerpolicy=strict-origin-when-cross-origin src="https://www.youtube.com/embed/wlvKAT7SZIQ?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 title="YouTube video"></iframe></div><p>Le programme Java suivant récupère et affiche les prévisions météo horaires pour Montréal en interrogeant l’API Open-Meteo, illustrant l’utilisation de l’API HTTP Client de Java 11 (java.net.http) et la manipulation de données JSON et temporelles. Les imports java.net.URI, java.net.http.HttpClient, java.net.http.HttpRequest et java.net.http.HttpResponse permettent de gérer les requêtes HTTP, tandis que java.time.LocalDateTime et java.time.format.DateTimeFormatter facilitent le traitement des horodatages. Le programme commence par définir les coordonnées géographiques de Montréal (latitude 45.5017, longitude -73.5673) et construit une URL pour demander les données horaires de température (temperature_2m) et de précipitations (precipitation). Ces imports et cette initialisation posent les bases pour une interaction réseau et une gestion efficace des données météorologiques.</p><p>Un HttpClient est créé avec HttpClient.newHttpClient(), offrant une configuration par défaut pour gérer les connexions HTTP. Une requête GET est construite via HttpRequest.newBuilder(), spécifiant l’URI de l’API Open-Meteo et la méthode GET, puis envoyée avec client.send(). La réponse, un JSON, est récupérée comme une chaîne grâce à HttpResponse.BodyHandlers.ofString(). Dans le contexte du protocole HTTP, cette requête GET récupère des données sans modifier la ressource serveur, et l’API Open-Meteo renvoie un JSON structuré contenant les prévisions. Le programme encapsule cette logique dans un bloc try-catch pour capturer les erreurs, comme les problèmes de connexion ou les réponses mal formées, démontrant une gestion basique mais essentielle des exceptions.</p><p>Le traitement du JSON repose sur une approche manuelle, sans bibliothèque externe. La méthode auxiliaire extractArray extrait les tableaux JSON pour les horaires (time), les températures (temperature_2m) et les précipitations (precipitation) en isolant les sous-chaînes entre crochets à partir des clés correspondantes. Cette méthode, bien que fonctionnelle, est sensible aux changements de structure du JSON, contrairement à des bibliothèques comme Jackson. Les données extraites sont divisées en tableaux de chaînes avec split(","), représentant les valeurs horaires. Cette étape illustre comment manipuler des données structurées issues d’une API REST, tout en mettant en lumière les limites d’un parsing manuel pour des applications complexes.</p><p>Une fois les données extraites, le programme utilise LocalDateTime et DateTimeFormatter pour traiter les horodatages au format UTC (yyyy-MM-dd&rsquo;T&rsquo;HH:mm) et les convertir en un format lisible (dd/MM/yyyy HH:mm). Une boucle parcourt les tableaux horaires, filtrant les prévisions antérieures à l’heure actuelle (LocalDateTime.now()) pour n’afficher que les 12 prochaines heures. Pour chaque heure valide, le programme affiche la date, la température (en °C) et les précipitations (en mm) avec un formatage précis via System.out.printf. Cette gestion temporelle permet de présenter des prévisions pertinentes, montrant l’importance des outils de la bibliothèque java.time pour les applications météorologiques.</p><div class=java-inline><div id=java-runner-1752020650615714397><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/eclipse.min.css><style>#java-runner-1752020650615714397 .export-form textarea{width:100%;min-height:120px;font-family:monospace;border-radius:4px;border:1px solid #ccc}#java-runner-1752020650615714397 .export-form{margin-bottom:0}#java-runner-1752020650615714397 .export-result{background:#222;color:#eee;padding:12px;border-radius:6px;margin-top:16px;white-space:pre-wrap;font-family:monospace}#java-runner-1752020650615714397 .export-endpoint-info{color:#1976d2;font-size:.98em;margin-top:8px}#java-runner-1752020650615714397 .export-btn{background:#1976d2;color:#fff;border:none;border-radius:4px;padding:8px 16px;font-size:1em;cursor:pointer;margin-top:8px}#java-runner-1752020650615714397 .export-file-block{max-width:100%;flex:1 1 350px;background:#f9f9f9;border:1px solid #ddd;border-radius:6px;padding:12px;margin-bottom:8px}#java-runner-1752020650615714397 .export-file-block .export-file-name{font-weight:700;margin-bottom:4px}.cm-java-error{background:#ffe0e0 !important;border-bottom:2px dotted #c00;cursor:pointer}.cm-java-error-line{background:#fff0f0 !important}</style><form class="export-form java-runner-1752020650615714397-form" style=margin-bottom:0><input type=hidden class=export-endpoint-var value=https://flask-service-inf1220-java.90qakjuvfj4f8.ca-central-1.cs.amazonlightsail.com/run><div style=display:flex;gap:12px;flex-wrap:wrap><div class=export-file-block><div class=export-file-name>WeatherForecast.java</div><textarea>

import java.net.URI;
import java.net.http.HttpClient;
import java.net.http.HttpRequest;
import java.net.http.HttpResponse;
import java.time.LocalDateTime;
import java.time.format.DateTimeFormatter;

public class WeatherForecast {
    public static void main(String[] args) {
        // Coordonnées de Montréal
        double latitude = 45.5017;
        double longitude = -73.5673;
        String url = &#34;https://api.open-meteo.com/v1/forecast?latitude=&#34; &#43; latitude &#43;
                     &#34;&longitude=&#34; &#43; longitude &#43; &#34;&hourly=temperature_2m,precipitation&#34;;

        try {
            // Créer un client HTTP
            HttpClient client = HttpClient.newHttpClient();
            HttpRequest request = HttpRequest.newBuilder()
                    .uri(URI.create(url))
                    .GET()
                    .build();

            // Envoyer la requête et obtenir la réponse
            HttpResponse&lt;String&gt; response = client.send(request, HttpResponse.BodyHandlers.ofString());
            String json = response.body();

            // Extraire les tableaux horaires
            String hourly = json.substring(json.indexOf(&#34;\&#34;hourly\&#34;:{&#34;));
            String times = extractArray(hourly, &#34;\&#34;time\&#34;:&#34;);
            String temperatures = extractArray(hourly, &#34;\&#34;temperature_2m\&#34;:&#34;);
            String precipitations = extractArray(hourly, &#34;\&#34;precipitation\&#34;:&#34;);

            // Formatter pour les dates
            DateTimeFormatter formatter = DateTimeFormatter.ofPattern(&#34;yyyy-MM-dd&#39;T&#39;HH:mm&#34;);

            // Afficher les prévisions pour les 12 prochaines heures
            System.out.println(&#34;Prévisions météo pour Montréal (prochaines 12 heures) :&#34;);
            LocalDateTime now = LocalDateTime.now();
            String[] timeArray = times.split(&#34;,&#34;);
            String[] tempArray = temperatures.split(&#34;,&#34;);
            String[] precipArray = precipitations.split(&#34;,&#34;);
            int count = 0;

            for (int i = 0; i &lt; timeArray.length && count &lt; 12; i&#43;&#43;) {
                String time = timeArray[i].replace(&#34;[\&#34;&#34;,&#34;&#34;).replace(&#34;\&#34;]&#34;,&#34;&#34;).replace(&#34;\&#34;&#34;,&#34;&#34;);
                LocalDateTime forecastTime = LocalDateTime.parse(time, formatter);
                if (forecastTime.isAfter(now)) {
                    double temp = Double.parseDouble(tempArray[i].replace(&#34;[&#34;,&#34;&#34;).replace(&#34;]&#34;,&#34;&#34;));
                    double precip = Double.parseDouble(precipArray[i].replace(&#34;[&#34;,&#34;&#34;).replace(&#34;]&#34;,&#34;&#34;));
                    System.out.printf(&#34;%s : %.1f°C, Précipitations : %.1f mm%n&#34;,
                            forecastTime.format(DateTimeFormatter.ofPattern(&#34;dd/MM/yyyy HH:mm&#34;)),
                            temp, precip);
                    count&#43;&#43;;
                }
            }
        } catch (Exception e) {
            System.err.println(&#34;Erreur lors de la récupération des données : &#34; &#43; e.getMessage());
        }
    }

    // Méthode pour extraire un tableau JSON spécifique
    private static String extractArray(String json, String key) {
        int start = json.indexOf(key) &#43; key.length();
        int end = json.indexOf(&#34;]&#34;, start) &#43; 1;
        return json.substring(start, end);
    }
}
</textarea></div></div><button type=submit class="export-btn java-runner-1752020650615714397-btn" style="background:#1976d2;color:#fff;border:none;border-radius:4px;padding:8px 16px;font-size:1em;cursor:pointer;margin-top:8px">Exécuter</button></form><div class=export-result></div><div class=java-error-tooltip style="display:none;position:absolute;z-index:1000;background:#fff0f0;color:#c00;border:1px solid #c00;padding:6px 12px;border-radius:6px;font-size:1em;box-shadow:0 2px 8px #0002"></div><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/clike/clike.min.js></script><script>(function(){var t,n,s,o,e=document.getElementById("java-runner-1752020650615714397");if(!e)return;s=e.querySelector("form"),t=e.querySelector(".export-result"),o=s.querySelector(".export-endpoint-var").value,n=e.querySelector(".java-error-tooltip"),e.querySelectorAll(".export-file-block").forEach(function(e){var t,n,s=e.querySelector(".export-file-name").textContent,o=e.querySelector("textarea");s.endsWith(".java")&&(n=CodeMirror.fromTextArea(o,{mode:"text/x-java",theme:"eclipse",lineNumbers:!0,indentUnit:4,tabSize:4}),e._cm=n,e._javaErrorLines={},n.on("cursorActivity",function(){var s,o,t=e.querySelector(".java-error-status-bar");if(!t)return;s=n.getCursor(),o=e._javaErrorLines&&e._javaErrorLines[s.line],o?(t.textContent="Ligne "+(s.line+1)+" : "+o,t.style.visibility="visible"):(t.textContent="",t.style.visibility="hidden")})),s.endsWith(".java")&&(e.querySelector(".java-error-status-bar")||(t=document.createElement("div"),t.className="java-error-status-bar",t.style.marginTop="4px",t.style.fontSize="0.95em",t.style.color="#c00",t.style.minHeight="1.2em",t.style.visibility="hidden",e.appendChild(t)))});function i(e,t,s){n.textContent=e,n.style.display="block",n.style.left=t+10+"px",n.style.top=s+10+"px"}function a(){n.style.display="none"}s.onsubmit=function(n){n.preventDefault();var s,i,a,r,c=[],l=[];e.querySelectorAll(".export-file-block").forEach(function(e){var t=e.querySelector(".export-file-name").textContent,s=e.querySelector("textarea"),n=e._cm?e._cm.getValue():s.value;t.endsWith(".java")?c.push({name:t,content:n}):l.push({name:t,content:n})}),s=0,t.textContent="Exécution en cours",i=setInterval(function(){s=(s+1)%4,t.textContent="Exécution en cours"+".".repeat(s)},500),a=new AbortController,r=setTimeout(function(){a.abort()},3e4),fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({java_files:c,txt_files:l}),signal:a.signal}).then(function(e){if(clearInterval(i),clearTimeout(r),!e.ok&&e.status!==400)throw new Error("Erreur HTTP "+e.status+" : "+e.statusText);return e.text()}).then(function(n){try{if(s=JSON.parse(n),s.status==="ran_successfully"?t.innerHTML='<pre style="color:#222;background:#e0ffe0;padding:12px;border-radius:6px;">'+(s.output||"").replace(/\n/g,"<br>")+"</pre>":s.status==="compiling"?t.innerHTML='<pre style="color:#c00;background:#ffe0e0;padding:12px;border-radius:6px;">'+(s.error||"").replace(/\n/g,"<br>")+"</pre>":s.status==="runtime_error"?t.innerHTML='<pre style="color:#c00;background:#ffe0e0;padding:12px;border-radius:6px;">'+(s.error||"").replace(/\n/g,"<br>")+"</pre>":t.textContent=n,s.status==="compiling"){for(c=s.error||"",l=new RegExp(`([\\w./\\-]+\\.java):(\\d+): error: ([^\\n]+)([\\s\\S]*?)(?=\\n[\\w./\\-]+\\.java:|$)`,"g"),e.querySelectorAll(".export-file-block").forEach(function(e){e._cm&&e._cm.operation(function(){for(var n=e._cm.getAllMarks(),t=0;t<n.length;t++)n[t].clear()}),e._javaErrorLines={};var t=e.querySelector(".java-error-status-bar");t&&(t.textContent="",t.style.visibility="hidden")});(o=l.exec(c))!==null;){var s,o,c,l,a=o[1],u=o[2],h=o[3],d=o[4],i=parseInt(u,10)-1,r=(h+(d?d.replace(/\s+/g," "):"")).trim();e.querySelectorAll(".export-file-block").forEach(function(e){var t=e.querySelector(".export-file-name");t&&(t.textContent.trim()===a||t.textContent.trim().endsWith("/"+a)||t.textContent.trim().endsWith("\\"+a))&&(e._cm&&e._cm.operation(function(){e._cm.markText({line:i,ch:0},{line:i+1,ch:0},{className:"cm-java-error",title:r})}),e._javaErrorLines||(e._javaErrorLines={}),e._javaErrorLines[i]=r)})}e.querySelectorAll(".export-file-block").forEach(function(e){if(e._cm&&e._cm.getOption("lineNumbers")){var n,s,t=e.querySelector(".java-error-status-bar");t&&(n=e._cm.getCursor(),s=e._javaErrorLines&&e._javaErrorLines[n.line],s?(t.textContent="Ligne "+(n.line+1)+" : "+s,t.style.visibility="visible"):(t.textContent="",t.style.visibility="hidden"))}})}else e.querySelectorAll(".export-file-block").forEach(function(e){e._cm&&e._cm.operation(function(){for(var n=e._cm.getAllMarks(),t=0;t<n.length;t++)n[t].clear()}),e._javaErrorLines={};var t=e.querySelector(".java-error-status-bar");t&&(t.textContent="",t.style.visibility="hidden")})}catch(e){console.log(e),t.textContent=n}}).catch(function(e){clearInterval(i),clearTimeout(r),e.name==="AbortError"?t.textContent="Erreur : délai d’attente dépassé (30 secondes).":t.textContent="Erreur lors de la requête : "+e})},e.querySelectorAll(".export-file-block").forEach(function(e){var t=e._cm;if(!t)return;t.on("mouseover",function(t,n){var a,o=t.coordsChar({left:n.clientX,top:n.clientY}),s=o.line,c=o.ch,r=t.getCursor();s===r.line&&e._javaErrorLines&&e._javaErrorLines[s]&&(a=e._javaErrorLines[s],i(a,n.clientX,n.clientY))}),t.on("mouseout",function(){a()})})})()</script></div></div><p>Les méthodes <strong>GET</strong> et <strong>POST</strong> sont deux des principales méthodes du protocole HTTP, utilisées pour interagir avec des serveurs web. Elles définissent l’intention de la requête envoyée par un client (comme une application ou un navigateur) à un serveur.
La méthode GET est utilisée pour récupérer des données d’un serveur sans modifier l’état de la ressource ciblée. Dans une requête GET, les paramètres sont généralement inclus dans l’URL, sous forme de chaîne de requête (par exemple, <code>?latitude=45.5017&amp;longitude=-73.5673</code>), et aucun corps de requête n’est envoyé. GET est idempotente, c’est-à-dire que plusieurs requêtes identiques produisent le même résultat, et elle est souvent utilisée pour des opérations de lecture, comme récupérer des profils d’utilisateurs ou des prévisions météo. Dans le programme <code>WeatherForecast</code>, une requête GET est envoyée à l’API Open-Meteo pour obtenir des données JSON sur la température et les précipitations, illustrant comment GET est adapté pour des requêtes de données publiques ou statiques.
Dans l’API <code>HttpClient</code> de Java, une requête GET est construite avec
<code>HttpRequest.newBuilder().GET().uri(URI.create(url)).build().</code>
Les en-têtes, comme <code>Accept: application/json</code>, peuvent être ajoutés pour spécifier le format de la réponse. Le serveur répond avec un code de statut (par exemple, 200 pour succès) et un corps contenant les données demandées, accessible via <code>HttpResponse.body()</code>. GET est idéal pour des scénarios où la sécurité des données n’est pas critique, car les paramètres dans l’URL sont visibles. Cependant, pour des données sensibles ou volumineuses, d’autres méthodes comme POST sont préférables, car GET est limité par la longueur maximale des URLs.
La méthode POST sert à envoyer des données au serveur pour créer ou modifier une ressource, comme soumettre un formulaire ou ajouter une entrée dans une base de données. Contrairement à GET, POST inclut un corps de requête contenant les données, souvent au format JSON ou formulaire, et les paramètres ne sont pas visibles dans l’URL, offrant une meilleure sécurité et une capacité à transmettre des données plus volumineuses. POST n’est pas idempotente : plusieurs requêtes identiques peuvent créer plusieurs ressources ou modifier l’état du serveur différemment. Dans le programme <code>HttpClientExample</code>, une requête POST envoie un JSON (<code>{"title": "Test", "body": "Test request"}</code>) à une API de test pour simuler la création d’une publication.
Avec l’API <code>HttpClient</code>, une requête POST est définie en utilisant
<code>HttpRequest.newBuilder().POST(HttpRequest.BodyPublishers.ofString(jsonPayload)).uri(URI.create(url)).build(),</code>
avec un en-tête comme <code>Content-Type: application/json</code> pour indiquer le format du corps. Le serveur traite les données envoyées et répond avec un code de statut (par exemple, 201 pour une création réussie) et parfois un corps décrivant la ressource créée. POST est essentiel pour les interactions dynamiques, comme l’envoi de données utilisateur ou la mise à jour de ressources, mais il nécessite une attention particulière à la sécurité, notamment avec HTTPS, pour protéger les données transmises.
Considérons un autre exemple pour bien illustrer ces concepts.</p><div class=java-inline><div id=java-runner-1752020650615787335><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/eclipse.min.css><style>#java-runner-1752020650615787335 .export-form textarea{width:100%;min-height:120px;font-family:monospace;border-radius:4px;border:1px solid #ccc}#java-runner-1752020650615787335 .export-form{margin-bottom:0}#java-runner-1752020650615787335 .export-result{background:#222;color:#eee;padding:12px;border-radius:6px;margin-top:16px;white-space:pre-wrap;font-family:monospace}#java-runner-1752020650615787335 .export-endpoint-info{color:#1976d2;font-size:.98em;margin-top:8px}#java-runner-1752020650615787335 .export-btn{background:#1976d2;color:#fff;border:none;border-radius:4px;padding:8px 16px;font-size:1em;cursor:pointer;margin-top:8px}#java-runner-1752020650615787335 .export-file-block{max-width:100%;flex:1 1 350px;background:#f9f9f9;border:1px solid #ddd;border-radius:6px;padding:12px;margin-bottom:8px}#java-runner-1752020650615787335 .export-file-block .export-file-name{font-weight:700;margin-bottom:4px}.cm-java-error{background:#ffe0e0 !important;border-bottom:2px dotted #c00;cursor:pointer}.cm-java-error-line{background:#fff0f0 !important}</style><form class="export-form java-runner-1752020650615787335-form" style=margin-bottom:0><input type=hidden class=export-endpoint-var value=https://flask-service-inf1220-java.90qakjuvfj4f8.ca-central-1.cs.amazonlightsail.com/run><div style=display:flex;gap:12px;flex-wrap:wrap><div class=export-file-block><div class=export-file-name>HttpClientExample.java</div><textarea>

import java.net.URI;
import java.net.http.HttpClient;
import java.net.http.HttpRequest;
import java.net.http.HttpResponse;
import java.nio.charset.StandardCharsets;

public class HttpClientExample {
    public static void main(String[] args) {
        // Création du client HTTP
        HttpClient client = HttpClient.newBuilder()
                .build();

        try {
            // Exemple de requête GET
            HttpRequest getRequest = HttpRequest.newBuilder()
                    .uri(URI.create(&#34;https://api.github.com/users/octocat&#34;))
                    .header(&#34;Accept&#34;, &#34;application/json&#34;)
                    .GET()
                    .build();

            HttpResponse&lt;String&gt; getResponse = client.send(getRequest, 
                    HttpResponse.BodyHandlers.ofString());
            
            System.out.println(&#34;GET Response Status: &#34; &#43; getResponse.statusCode());
            System.out.println(&#34;GET Response Body: &#34; &#43; getResponse.body());

            // Exemple de requête POST
            String jsonPayload = &#34;{\&#34;title\&#34;: \&#34;Test\&#34;, \&#34;body\&#34;: \&#34;Test request\&#34;}&#34;;
            HttpRequest postRequest = HttpRequest.newBuilder()
                    .uri(URI.create(&#34;https://jsonplaceholder.typicode.com/posts&#34;))
                    .header(&#34;Content-Type&#34;, &#34;application/json&#34;)
                    .POST(HttpRequest.BodyPublishers.ofString(jsonPayload, StandardCharsets.UTF_8))
                    .build();

            HttpResponse&lt;String&gt; postResponse = client.send(postRequest, 
                    HttpResponse.BodyHandlers.ofString());
            
            System.out.println(&#34;\nPOST Response Status: &#34; &#43; postResponse.statusCode());
            System.out.println(&#34;POST Response Body: &#34; &#43; postResponse.body());

        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
</textarea></div></div><button type=submit class="export-btn java-runner-1752020650615787335-btn" style="background:#1976d2;color:#fff;border:none;border-radius:4px;padding:8px 16px;font-size:1em;cursor:pointer;margin-top:8px">Exécuter</button></form><div class=export-result></div><div class=java-error-tooltip style="display:none;position:absolute;z-index:1000;background:#fff0f0;color:#c00;border:1px solid #c00;padding:6px 12px;border-radius:6px;font-size:1em;box-shadow:0 2px 8px #0002"></div><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/clike/clike.min.js></script><script>(function(){var t,n,s,o,e=document.getElementById("java-runner-1752020650615787335");if(!e)return;s=e.querySelector("form"),t=e.querySelector(".export-result"),o=s.querySelector(".export-endpoint-var").value,n=e.querySelector(".java-error-tooltip"),e.querySelectorAll(".export-file-block").forEach(function(e){var t,n,s=e.querySelector(".export-file-name").textContent,o=e.querySelector("textarea");s.endsWith(".java")&&(n=CodeMirror.fromTextArea(o,{mode:"text/x-java",theme:"eclipse",lineNumbers:!0,indentUnit:4,tabSize:4}),e._cm=n,e._javaErrorLines={},n.on("cursorActivity",function(){var s,o,t=e.querySelector(".java-error-status-bar");if(!t)return;s=n.getCursor(),o=e._javaErrorLines&&e._javaErrorLines[s.line],o?(t.textContent="Ligne "+(s.line+1)+" : "+o,t.style.visibility="visible"):(t.textContent="",t.style.visibility="hidden")})),s.endsWith(".java")&&(e.querySelector(".java-error-status-bar")||(t=document.createElement("div"),t.className="java-error-status-bar",t.style.marginTop="4px",t.style.fontSize="0.95em",t.style.color="#c00",t.style.minHeight="1.2em",t.style.visibility="hidden",e.appendChild(t)))});function i(e,t,s){n.textContent=e,n.style.display="block",n.style.left=t+10+"px",n.style.top=s+10+"px"}function a(){n.style.display="none"}s.onsubmit=function(n){n.preventDefault();var s,i,a,r,c=[],l=[];e.querySelectorAll(".export-file-block").forEach(function(e){var t=e.querySelector(".export-file-name").textContent,s=e.querySelector("textarea"),n=e._cm?e._cm.getValue():s.value;t.endsWith(".java")?c.push({name:t,content:n}):l.push({name:t,content:n})}),s=0,t.textContent="Exécution en cours",i=setInterval(function(){s=(s+1)%4,t.textContent="Exécution en cours"+".".repeat(s)},500),a=new AbortController,r=setTimeout(function(){a.abort()},3e4),fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({java_files:c,txt_files:l}),signal:a.signal}).then(function(e){if(clearInterval(i),clearTimeout(r),!e.ok&&e.status!==400)throw new Error("Erreur HTTP "+e.status+" : "+e.statusText);return e.text()}).then(function(n){try{if(s=JSON.parse(n),s.status==="ran_successfully"?t.innerHTML='<pre style="color:#222;background:#e0ffe0;padding:12px;border-radius:6px;">'+(s.output||"").replace(/\n/g,"<br>")+"</pre>":s.status==="compiling"?t.innerHTML='<pre style="color:#c00;background:#ffe0e0;padding:12px;border-radius:6px;">'+(s.error||"").replace(/\n/g,"<br>")+"</pre>":s.status==="runtime_error"?t.innerHTML='<pre style="color:#c00;background:#ffe0e0;padding:12px;border-radius:6px;">'+(s.error||"").replace(/\n/g,"<br>")+"</pre>":t.textContent=n,s.status==="compiling"){for(c=s.error||"",l=new RegExp(`([\\w./\\-]+\\.java):(\\d+): error: ([^\\n]+)([\\s\\S]*?)(?=\\n[\\w./\\-]+\\.java:|$)`,"g"),e.querySelectorAll(".export-file-block").forEach(function(e){e._cm&&e._cm.operation(function(){for(var n=e._cm.getAllMarks(),t=0;t<n.length;t++)n[t].clear()}),e._javaErrorLines={};var t=e.querySelector(".java-error-status-bar");t&&(t.textContent="",t.style.visibility="hidden")});(o=l.exec(c))!==null;){var s,o,c,l,a=o[1],u=o[2],h=o[3],d=o[4],i=parseInt(u,10)-1,r=(h+(d?d.replace(/\s+/g," "):"")).trim();e.querySelectorAll(".export-file-block").forEach(function(e){var t=e.querySelector(".export-file-name");t&&(t.textContent.trim()===a||t.textContent.trim().endsWith("/"+a)||t.textContent.trim().endsWith("\\"+a))&&(e._cm&&e._cm.operation(function(){e._cm.markText({line:i,ch:0},{line:i+1,ch:0},{className:"cm-java-error",title:r})}),e._javaErrorLines||(e._javaErrorLines={}),e._javaErrorLines[i]=r)})}e.querySelectorAll(".export-file-block").forEach(function(e){if(e._cm&&e._cm.getOption("lineNumbers")){var n,s,t=e.querySelector(".java-error-status-bar");t&&(n=e._cm.getCursor(),s=e._javaErrorLines&&e._javaErrorLines[n.line],s?(t.textContent="Ligne "+(n.line+1)+" : "+s,t.style.visibility="visible"):(t.textContent="",t.style.visibility="hidden"))}})}else e.querySelectorAll(".export-file-block").forEach(function(e){e._cm&&e._cm.operation(function(){for(var n=e._cm.getAllMarks(),t=0;t<n.length;t++)n[t].clear()}),e._javaErrorLines={};var t=e.querySelector(".java-error-status-bar");t&&(t.textContent="",t.style.visibility="hidden")})}catch(e){console.log(e),t.textContent=n}}).catch(function(e){clearInterval(i),clearTimeout(r),e.name==="AbortError"?t.textContent="Erreur : délai d’attente dépassé (30 secondes).":t.textContent="Erreur lors de la requête : "+e})},e.querySelectorAll(".export-file-block").forEach(function(e){var t=e._cm;if(!t)return;t.on("mouseover",function(t,n){var a,o=t.coordsChar({left:n.clientX,top:n.clientY}),s=o.line,c=o.ch,r=t.getCursor();s===r.line&&e._javaErrorLines&&e._javaErrorLines[s]&&(a=e._javaErrorLines[s],i(a,n.clientX,n.clientY))}),t.on("mouseout",function(){a()})})})()</script></div></div><p>Le programme démontre deux cas d’usage : récupérer des données d’une API publique (GET) et simuler la création d’une ressource (POST).
Le programme commence par créer un <code>HttpClient</code>, l’objet central pour gérer les connexions HTTP. La ligne
<code>HttpClient client = HttpClient.newBuilder().build();</code>
initialise un client avec des paramètres par défaut, capable de gérer plusieurs requêtes tout en optimisant les connexions réseau (par exemple, via HTTP/1.1 ou HTTP/2). Dans le contexte HTTP, le client joue le rôle de l’initiateur des requêtes, envoyant des messages formatés au serveur. Le programme encapsule ensuite le code dans un bloc <code>try-catch</code> pour gérer les exceptions, comme les erreurs réseau ou les réponses invalides, qui sont courantes dans les communications HTTP en raison de la nature distribuée du web.</p><p>La première requête est une requête GET vers l’API GitHub (<code>https://api.github.com/users/octocat</code>). La construction de la requête utilise <code>HttpRequest.newBuilder()</code>, où l’URI est définie, un en-tête <code>Accept: application/json</code> est ajouté pour demander une réponse JSON, et la méthode <code>GET()</code> est spécifiée. En HTTP, GET est utilisé pour récupérer des données sans modifier la ressource, et l’en-tête <code>Accept</code> négocie le format de la réponse. La requête est envoyée avec <code>client.send()</code>, qui retourne un <code>HttpResponse</code> contenant le code de statut (par exemple, 200 pour succès) et le corps (un JSON décrivant l’utilisateur). Le programme affiche ces informations, illustrant comment HTTP structure les réponses pour fournir à la fois des métadonnées (code de statut, en-têtes) et des données utiles.</p><p>La deuxième requête est une requête POST vers une API de test (<code>https://jsonplaceholder.typicode.com/posts</code>). Une chaîne JSON (<code>{"title": "Test", "body": "Test request"}</code>) est préparée comme corps de la requête, et l’en-tête <code>Content-Type: application/json</code> indique au serveur que les données envoyées sont du JSON. La méthode <code>POST()</code> attache ce corps, encodé en UTF-8, à la requête. En HTTP, POST est utilisé pour créer ou modifier des ressources, et le corps transporte les données à traiter par le serveur. La requête est envoyée de manière similaire à la requête GET, et la réponse (code de statut et corps JSON) est affichée. Cette API de test simule la création d’une ressource, renvoyant un JSON avec un ID généré, ce qui reflète une pratique courante dans les API REST.</p><h2 id=performance>Performance
<a class=anchor href=#performance>#</a></h2><blockquote class="book-hint info"><p>Dans ce cours, vous n&rsquo;avez pas à maîtriser la performance.</p></blockquote><p>La performance est un enjeu crucial lorsqu’on manipule des fichiers ou des flux de données, surtout avec de grands volumes ou des opérations répétées. Un code inefficace peut entraîner des ralentissements importants, une consommation excessive de mémoire ou des blocages inutiles.</p><p>Lire ou écrire un fichier caractère par caractère est très lent. Il vaut mieux utiliser des tampons (buffers) pour traiter plusieurs caractères ou octets à la fois. C&rsquo;est un peu comme essayer d&rsquo;envoyer un message texte par quelqu&rsquo;un caractère par caractère.</p><p>Les requêtes HTTP ou les accès à des fichiers distants sont beaucoup plus lents que les accès en mémoire. Il faut donc limiter leur nombre et traiter les données efficacement.</p><p>Dans cet exemple, <code>BufferedReader</code> lit le fichier par blocs (c&rsquo;est-à-dire plusieurs caractères à la fois), ce qui réduit considérablement le nombre d&rsquo;accès disque et accélère la lecture, surtout pour les gros fichiers. Plutôt que de lire un caractère à la fois (ce qui serait très lent), le tampon (buffer) permet de charger une portion du fichier en mémoire, puis de traiter cette portion ligne par ligne ou caractère par caractère en mémoire vive, ce qui est bien plus efficace.</p><p>De la même façon, pour l&rsquo;écriture, la classe <code>BufferedWriter</code> permet d&rsquo;écrire dans un fichier par blocs, en accumulant les caractères dans un tampon avant de les écrire d&rsquo;un coup sur le disque. Cela réduit le nombre d&rsquo;opérations d&rsquo;écriture physiques, ce qui améliore la performance.</p><p>Voici un exemple complet de lecture et d&rsquo;écriture performantes avec <code>BufferedReader</code> et <code>BufferedWriter</code> :</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#cf222e>import</span><span style=color:#fff> </span><span style=color:#24292e>java.io.*</span><span style=color:#1f2328>;</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#cf222e>public</span><span style=color:#fff> </span><span style=color:#cf222e>class</span> <span style=color:#1f2328>ExempleBuffer</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#cf222e>public</span><span style=color:#fff> </span><span style=color:#cf222e>static</span><span style=color:#fff> </span><span style=color:#cf222e>void</span><span style=color:#fff> </span><span style=color:#6639ba>main</span><span style=color:#1f2328>(</span>String<span style=color:#0550ae>[]</span><span style=color:#fff> </span>args<span style=color:#1f2328>)</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>        </span><span style=color:#57606a>// Lecture performante</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>        </span><span style=color:#cf222e>try</span><span style=color:#fff> </span><span style=color:#1f2328>(</span>BufferedReader<span style=color:#fff> </span>reader<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span><span style=color:#cf222e>new</span><span style=color:#fff> </span>BufferedReader<span style=color:#1f2328>(</span><span style=color:#cf222e>new</span><span style=color:#fff> </span>FileReader<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;entree.txt&#34;</span><span style=color:#1f2328>)))</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>            </span>String<span style=color:#fff> </span>ligne<span style=color:#1f2328>;</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>            </span><span style=color:#cf222e>while</span><span style=color:#fff> </span><span style=color:#1f2328>((</span>ligne<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span>reader<span style=color:#1f2328>.</span><span style=color:#1f2328>readLine</span><span style=color:#1f2328>())</span><span style=color:#fff> </span><span style=color:#0550ae>!=</span><span style=color:#fff> </span><span style=color:#cf222e>null</span><span style=color:#1f2328>)</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>                </span>System<span style=color:#1f2328>.</span><span style=color:#1f2328>out</span><span style=color:#1f2328>.</span><span style=color:#1f2328>println</span><span style=color:#1f2328>(</span>ligne<span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>            </span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>        </span><span style=color:#1f2328>}</span><span style=color:#fff> </span><span style=color:#cf222e>catch</span><span style=color:#fff> </span><span style=color:#1f2328>(</span>IOException<span style=color:#fff> </span>e<span style=color:#1f2328>)</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>            </span>System<span style=color:#1f2328>.</span><span style=color:#1f2328>err</span><span style=color:#1f2328>.</span><span style=color:#1f2328>println</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;Erreur de lecture : &#34;</span><span style=color:#fff> </span><span style=color:#0550ae>+</span><span style=color:#fff> </span>e<span style=color:#1f2328>.</span><span style=color:#1f2328>getMessage</span><span style=color:#1f2328>());</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>        </span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>        </span><span style=color:#57606a>// Écriture performante</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>        </span><span style=color:#cf222e>try</span><span style=color:#fff> </span><span style=color:#1f2328>(</span>BufferedWriter<span style=color:#fff> </span>writer<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span><span style=color:#cf222e>new</span><span style=color:#fff> </span>BufferedWriter<span style=color:#1f2328>(</span><span style=color:#cf222e>new</span><span style=color:#fff> </span>FileWriter<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;sortie.txt&#34;</span><span style=color:#1f2328>)))</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>            </span>writer<span style=color:#1f2328>.</span><span style=color:#1f2328>write</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;Ceci est une ligne écrite rapidement grâce au buffer.\n&#34;</span><span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>            </span>writer<span style=color:#1f2328>.</span><span style=color:#1f2328>write</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;Une autre ligne.\n&#34;</span><span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>        </span><span style=color:#1f2328>}</span><span style=color:#fff> </span><span style=color:#cf222e>catch</span><span style=color:#fff> </span><span style=color:#1f2328>(</span>IOException<span style=color:#fff> </span>e<span style=color:#1f2328>)</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>            </span>System<span style=color:#1f2328>.</span><span style=color:#1f2328>err</span><span style=color:#1f2328>.</span><span style=color:#1f2328>println</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;Erreur d&#39;écriture : &#34;</span><span style=color:#fff> </span><span style=color:#0550ae>+</span><span style=color:#fff> </span>e<span style=color:#1f2328>.</span><span style=color:#1f2328>getMessage</span><span style=color:#1f2328>());</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>        </span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span></code></pre></div><p>Utiliser <code>BufferedReader</code> et <code>BufferedWriter</code> est essentiel pour la performance lors de la lecture et l&rsquo;écriture de fichiers texte en Java. Cela permet de traiter efficacement de grands volumes de données tout en minimisant les accès disque, ce qui accélère significativement les opérations d&rsquo;entrée/sortie.</p><h3 id=données-binaires-et-performance>Données binaires et performance
<a class=anchor href=#donn%c3%a9es-binaires-et-performance>#</a></h3><p>Pour les fichiers binaires (images, sons, vidéos, données structurées, etc.), le principe de la lecture/écriture en bloc reste tout aussi important. En Java, on utilise alors <code>BufferedInputStream</code> et <code>BufferedOutputStream</code> pour optimiser les opérations sur les flux binaires. Ces classes fonctionnent de façon similaire à leurs équivalents pour le texte, mais traitent des octets au lieu de caractères.</p><p>L&rsquo;utilisation de buffers permet de lire ou d&rsquo;écrire plusieurs kilo-octets d&rsquo;un coup, ce qui réduit le nombre d&rsquo;accès disque et améliore la rapidité, surtout pour les gros fichiers binaires.</p><p>Voici un exemple de copie performante d&rsquo;un fichier binaire :</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#cf222e>import</span><span style=color:#fff> </span><span style=color:#24292e>java.io.*</span><span style=color:#1f2328>;</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#cf222e>public</span><span style=color:#fff> </span><span style=color:#cf222e>class</span> <span style=color:#1f2328>CopieBinaire</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#cf222e>public</span><span style=color:#fff> </span><span style=color:#cf222e>static</span><span style=color:#fff> </span><span style=color:#cf222e>void</span><span style=color:#fff> </span><span style=color:#6639ba>main</span><span style=color:#1f2328>(</span>String<span style=color:#0550ae>[]</span><span style=color:#fff> </span>args<span style=color:#1f2328>)</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>        </span><span style=color:#cf222e>try</span><span style=color:#fff> </span><span style=color:#1f2328>(</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>            </span>BufferedInputStream<span style=color:#fff> </span>in<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span><span style=color:#cf222e>new</span><span style=color:#fff> </span>BufferedInputStream<span style=color:#1f2328>(</span><span style=color:#cf222e>new</span><span style=color:#fff> </span>FileInputStream<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;source.bin&#34;</span><span style=color:#1f2328>));</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>            </span>BufferedOutputStream<span style=color:#fff> </span>out<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span><span style=color:#cf222e>new</span><span style=color:#fff> </span>BufferedOutputStream<span style=color:#1f2328>(</span><span style=color:#cf222e>new</span><span style=color:#fff> </span>FileOutputStream<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;destination.bin&#34;</span><span style=color:#1f2328>));</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>        </span><span style=color:#1f2328>)</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>            </span><span style=color:#cf222e>byte</span><span style=color:#0550ae>[]</span><span style=color:#fff> </span>buffer<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span><span style=color:#cf222e>new</span><span style=color:#fff> </span><span style=color:#cf222e>byte</span><span style=color:#0550ae>[</span>8192<span style=color:#0550ae>]</span><span style=color:#1f2328>;</span><span style=color:#fff> </span><span style=color:#57606a>// 8 Ko</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>            </span><span style=color:#cf222e>int</span><span style=color:#fff> </span>bytesRead<span style=color:#1f2328>;</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>            </span><span style=color:#cf222e>while</span><span style=color:#fff> </span><span style=color:#1f2328>((</span>bytesRead<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span>in<span style=color:#1f2328>.</span><span style=color:#1f2328>read</span><span style=color:#1f2328>(</span>buffer<span style=color:#1f2328>))</span><span style=color:#fff> </span><span style=color:#0550ae>!=</span><span style=color:#fff> </span><span style=color:#0550ae>-</span>1<span style=color:#1f2328>)</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>                </span>out<span style=color:#1f2328>.</span><span style=color:#1f2328>write</span><span style=color:#1f2328>(</span>buffer<span style=color:#1f2328>,</span><span style=color:#fff> </span>0<span style=color:#1f2328>,</span><span style=color:#fff> </span>bytesRead<span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>            </span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>        </span><span style=color:#1f2328>}</span><span style=color:#fff> </span><span style=color:#cf222e>catch</span><span style=color:#fff> </span><span style=color:#1f2328>(</span>IOException<span style=color:#fff> </span>e<span style=color:#1f2328>)</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>            </span>System<span style=color:#1f2328>.</span><span style=color:#1f2328>err</span><span style=color:#1f2328>.</span><span style=color:#1f2328>println</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;Erreur lors de la copie : &#34;</span><span style=color:#fff> </span><span style=color:#0550ae>+</span><span style=color:#fff> </span>e<span style=color:#1f2328>.</span><span style=color:#1f2328>getMessage</span><span style=color:#1f2328>());</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>        </span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span></code></pre></div><p>Pour les fichiers binaires, il est essentiel d&rsquo;utiliser des buffers pour garantir des performances optimales. Cela permet de manipuler efficacement de grandes quantités de données, tout en minimisant la sollicitation du disque dur.</p><h4 id=filechannel-et-buffer>FileChannel et Buffer
<a class=anchor href=#filechannel-et-buffer>#</a></h4><blockquote class="book-hint info"><p>Dans ce cours, vous n&rsquo;avez pas à maîtriser les FileChannel et les Buffer.</p></blockquote><p>Les classes Buffer en Java, situées dans le package java.nio, sont des conteneurs pour manipuler des données brutes en mémoire, utilisées principalement pour des opérations d’entrée/sortie performantes. Un Buffer encapsule un tableau de données avec des métadonnées comme la position (index de la prochaine donnée à lire/écrire), la limite (fin des données valides) et la capacité (taille totale). Ces classes permettent des opérations comme put() pour écrire, get() pour lire, flip() pour basculer entre modes lecture/écriture, et clear() ou rewind() pour réinitialiser. Elles sont particulièrement utiles pour les applications nécessitant un traitement efficace de données binaires ou textuelles, comme les communications réseau ou la lecture/écriture de fichiers volumineux, offrant un contrôle granulaire par rapport aux flux traditionnels.</p><div class=java-inline><div id=java-runner-1752020650615843190><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/eclipse.min.css><style>#java-runner-1752020650615843190 .export-form textarea{width:100%;min-height:120px;font-family:monospace;border-radius:4px;border:1px solid #ccc}#java-runner-1752020650615843190 .export-form{margin-bottom:0}#java-runner-1752020650615843190 .export-result{background:#222;color:#eee;padding:12px;border-radius:6px;margin-top:16px;white-space:pre-wrap;font-family:monospace}#java-runner-1752020650615843190 .export-endpoint-info{color:#1976d2;font-size:.98em;margin-top:8px}#java-runner-1752020650615843190 .export-btn{background:#1976d2;color:#fff;border:none;border-radius:4px;padding:8px 16px;font-size:1em;cursor:pointer;margin-top:8px}#java-runner-1752020650615843190 .export-file-block{max-width:100%;flex:1 1 350px;background:#f9f9f9;border:1px solid #ddd;border-radius:6px;padding:12px;margin-bottom:8px}#java-runner-1752020650615843190 .export-file-block .export-file-name{font-weight:700;margin-bottom:4px}.cm-java-error{background:#ffe0e0 !important;border-bottom:2px dotted #c00;cursor:pointer}.cm-java-error-line{background:#fff0f0 !important}</style><form class="export-form java-runner-1752020650615843190-form" style=margin-bottom:0><input type=hidden class=export-endpoint-var value=https://flask-service-inf1220-java.90qakjuvfj4f8.ca-central-1.cs.amazonlightsail.com/run><div style=display:flex;gap:12px;flex-wrap:wrap><div class=export-file-block><div class=export-file-name>ByteBufferExample.java</div><textarea>
import java.nio.ByteBuffer;
import java.nio.charset.StandardCharsets;

public class ByteBufferExample {
    public static void main(String[] args) {
        // Création d’un ByteBuffer avec une capacité de 20 octets
        ByteBuffer buffer = ByteBuffer.allocate(20);
        
        // Écriture d’une chaîne dans le buffer
        String message = &#34;Bonjour NIO&#34;;
        buffer.put(message.getBytes(StandardCharsets.UTF_8));
        System.out.println(&#34;Après écriture : position = &#34; &#43; buffer.position() &#43; &#34;, limite = &#34; &#43; buffer.limit());
        
        // Basculement en mode lecture
        buffer.flip();
        System.out.println(&#34;Après flip : position = &#34; &#43; buffer.position() &#43; &#34;, limite = &#34; &#43; buffer.limit());
        
        // Lecture et affichage des données
        System.out.print(&#34;Contenu lu : &#34;);
        while (buffer.hasRemaining()) {
            System.out.print((char) buffer.get());
        }
        System.out.println();
        
        // Réinitialisation pour réutilisation
        buffer.clear();
        System.out.println(&#34;Après clear : position = &#34; &#43; buffer.position() &#43; &#34;, limite = &#34; &#43; buffer.limit());
    }
}
</textarea></div></div><button type=submit class="export-btn java-runner-1752020650615843190-btn" style="background:#1976d2;color:#fff;border:none;border-radius:4px;padding:8px 16px;font-size:1em;cursor:pointer;margin-top:8px">Exécuter</button></form><div class=export-result></div><div class=java-error-tooltip style="display:none;position:absolute;z-index:1000;background:#fff0f0;color:#c00;border:1px solid #c00;padding:6px 12px;border-radius:6px;font-size:1em;box-shadow:0 2px 8px #0002"></div><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/clike/clike.min.js></script><script>(function(){var t,n,s,o,e=document.getElementById("java-runner-1752020650615843190");if(!e)return;s=e.querySelector("form"),t=e.querySelector(".export-result"),o=s.querySelector(".export-endpoint-var").value,n=e.querySelector(".java-error-tooltip"),e.querySelectorAll(".export-file-block").forEach(function(e){var t,n,s=e.querySelector(".export-file-name").textContent,o=e.querySelector("textarea");s.endsWith(".java")&&(n=CodeMirror.fromTextArea(o,{mode:"text/x-java",theme:"eclipse",lineNumbers:!0,indentUnit:4,tabSize:4}),e._cm=n,e._javaErrorLines={},n.on("cursorActivity",function(){var s,o,t=e.querySelector(".java-error-status-bar");if(!t)return;s=n.getCursor(),o=e._javaErrorLines&&e._javaErrorLines[s.line],o?(t.textContent="Ligne "+(s.line+1)+" : "+o,t.style.visibility="visible"):(t.textContent="",t.style.visibility="hidden")})),s.endsWith(".java")&&(e.querySelector(".java-error-status-bar")||(t=document.createElement("div"),t.className="java-error-status-bar",t.style.marginTop="4px",t.style.fontSize="0.95em",t.style.color="#c00",t.style.minHeight="1.2em",t.style.visibility="hidden",e.appendChild(t)))});function i(e,t,s){n.textContent=e,n.style.display="block",n.style.left=t+10+"px",n.style.top=s+10+"px"}function a(){n.style.display="none"}s.onsubmit=function(n){n.preventDefault();var s,i,a,r,c=[],l=[];e.querySelectorAll(".export-file-block").forEach(function(e){var t=e.querySelector(".export-file-name").textContent,s=e.querySelector("textarea"),n=e._cm?e._cm.getValue():s.value;t.endsWith(".java")?c.push({name:t,content:n}):l.push({name:t,content:n})}),s=0,t.textContent="Exécution en cours",i=setInterval(function(){s=(s+1)%4,t.textContent="Exécution en cours"+".".repeat(s)},500),a=new AbortController,r=setTimeout(function(){a.abort()},3e4),fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({java_files:c,txt_files:l}),signal:a.signal}).then(function(e){if(clearInterval(i),clearTimeout(r),!e.ok&&e.status!==400)throw new Error("Erreur HTTP "+e.status+" : "+e.statusText);return e.text()}).then(function(n){try{if(s=JSON.parse(n),s.status==="ran_successfully"?t.innerHTML='<pre style="color:#222;background:#e0ffe0;padding:12px;border-radius:6px;">'+(s.output||"").replace(/\n/g,"<br>")+"</pre>":s.status==="compiling"?t.innerHTML='<pre style="color:#c00;background:#ffe0e0;padding:12px;border-radius:6px;">'+(s.error||"").replace(/\n/g,"<br>")+"</pre>":s.status==="runtime_error"?t.innerHTML='<pre style="color:#c00;background:#ffe0e0;padding:12px;border-radius:6px;">'+(s.error||"").replace(/\n/g,"<br>")+"</pre>":t.textContent=n,s.status==="compiling"){for(c=s.error||"",l=new RegExp(`([\\w./\\-]+\\.java):(\\d+): error: ([^\\n]+)([\\s\\S]*?)(?=\\n[\\w./\\-]+\\.java:|$)`,"g"),e.querySelectorAll(".export-file-block").forEach(function(e){e._cm&&e._cm.operation(function(){for(var n=e._cm.getAllMarks(),t=0;t<n.length;t++)n[t].clear()}),e._javaErrorLines={};var t=e.querySelector(".java-error-status-bar");t&&(t.textContent="",t.style.visibility="hidden")});(o=l.exec(c))!==null;){var s,o,c,l,a=o[1],u=o[2],h=o[3],d=o[4],i=parseInt(u,10)-1,r=(h+(d?d.replace(/\s+/g," "):"")).trim();e.querySelectorAll(".export-file-block").forEach(function(e){var t=e.querySelector(".export-file-name");t&&(t.textContent.trim()===a||t.textContent.trim().endsWith("/"+a)||t.textContent.trim().endsWith("\\"+a))&&(e._cm&&e._cm.operation(function(){e._cm.markText({line:i,ch:0},{line:i+1,ch:0},{className:"cm-java-error",title:r})}),e._javaErrorLines||(e._javaErrorLines={}),e._javaErrorLines[i]=r)})}e.querySelectorAll(".export-file-block").forEach(function(e){if(e._cm&&e._cm.getOption("lineNumbers")){var n,s,t=e.querySelector(".java-error-status-bar");t&&(n=e._cm.getCursor(),s=e._javaErrorLines&&e._javaErrorLines[n.line],s?(t.textContent="Ligne "+(n.line+1)+" : "+s,t.style.visibility="visible"):(t.textContent="",t.style.visibility="hidden"))}})}else e.querySelectorAll(".export-file-block").forEach(function(e){e._cm&&e._cm.operation(function(){for(var n=e._cm.getAllMarks(),t=0;t<n.length;t++)n[t].clear()}),e._javaErrorLines={};var t=e.querySelector(".java-error-status-bar");t&&(t.textContent="",t.style.visibility="hidden")})}catch(e){console.log(e),t.textContent=n}}).catch(function(e){clearInterval(i),clearTimeout(r),e.name==="AbortError"?t.textContent="Erreur : délai d’attente dépassé (30 secondes).":t.textContent="Erreur lors de la requête : "+e})},e.querySelectorAll(".export-file-block").forEach(function(e){var t=e._cm;if(!t)return;t.on("mouseover",function(t,n){var a,o=t.coordsChar({left:n.clientX,top:n.clientY}),s=o.line,c=o.ch,r=t.getCursor();s===r.line&&e._javaErrorLines&&e._javaErrorLines[s]&&(a=e._javaErrorLines[s],i(a,n.clientX,n.clientY))}),t.on("mouseout",function(){a()})})})()</script></div></div><p>FileChannel est une classe du package java.nio.channels en Java, conçue pour des opérations d’entrée/sortie performantes sur des fichiers ou d’autres sources. Elle permet de lire, écrire, ou <em>mapper</em> des fichiers en mémoire à l’aide de buffers, tels que ByteBuffer, offrant un contrôle précis sur les positions et les tailles des données manipulées. Ouvert via des méthodes comme FileChannel.open ou à partir de flux comme FileInputStream.getChannel(), il est particulièrement adapté aux applications nécessitant une gestion efficace de fichiers volumineux ou des communications réseau.</p><p>Nous allons un programme Java qui utilise l’API java.nio pour créer un fichier, y écrire des données, puis effectuer un mappage en mémoire (<em>memory mapping</em>) avec FileChannel et MappedByteBuffer. Le mappage en mémoire permet d’accéder au contenu du fichier comme s’il s’agissait d’un tableau de bytes en mémoire, offrant des performances élevées pour les opérations de lecture et d’écriture, surtout pour les fichiers volumineux.
Le mappage est efficace pour les fichiers volumineux, car il évite de charger tout le contenu en mémoire à la fois.</p><div class=java-inline><div id=java-runner-1752020650615939461><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/eclipse.min.css><style>#java-runner-1752020650615939461 .export-form textarea{width:100%;min-height:120px;font-family:monospace;border-radius:4px;border:1px solid #ccc}#java-runner-1752020650615939461 .export-form{margin-bottom:0}#java-runner-1752020650615939461 .export-result{background:#222;color:#eee;padding:12px;border-radius:6px;margin-top:16px;white-space:pre-wrap;font-family:monospace}#java-runner-1752020650615939461 .export-endpoint-info{color:#1976d2;font-size:.98em;margin-top:8px}#java-runner-1752020650615939461 .export-btn{background:#1976d2;color:#fff;border:none;border-radius:4px;padding:8px 16px;font-size:1em;cursor:pointer;margin-top:8px}#java-runner-1752020650615939461 .export-file-block{max-width:100%;flex:1 1 350px;background:#f9f9f9;border:1px solid #ddd;border-radius:6px;padding:12px;margin-bottom:8px}#java-runner-1752020650615939461 .export-file-block .export-file-name{font-weight:700;margin-bottom:4px}.cm-java-error{background:#ffe0e0 !important;border-bottom:2px dotted #c00;cursor:pointer}.cm-java-error-line{background:#fff0f0 !important}</style><form class="export-form java-runner-1752020650615939461-form" style=margin-bottom:0><input type=hidden class=export-endpoint-var value=https://flask-service-inf1220-java.90qakjuvfj4f8.ca-central-1.cs.amazonlightsail.com/run><div style=display:flex;gap:12px;flex-wrap:wrap><div class=export-file-block><div class=export-file-name>MemoryMappedFileExample.java</div><textarea>
import java.nio.file.Path;
import java.nio.file.StandardOpenOption;
import java.nio.ByteBuffer;
import java.nio.channels.FileChannel;
import java.nio.MappedByteBuffer;
import java.io.IOException;

public class MemoryMappedFileExample {
    public static void main(String[] args) {
        Path chemin = Path.of(&#34;mapped_data.bin&#34;);
        int nombreEntiers = 10; // Nombre d’entiers à écrire
        int tailleFichier = nombreEntiers * 4; // 4 octets par int

        // Étape 1 : Création et écriture dans le fichier
        try (FileChannel canal = FileChannel.open(chemin, StandardOpenOption.CREATE, StandardOpenOption.WRITE, StandardOpenOption.TRUNCATE_EXISTING)) {
            ByteBuffer buffer = ByteBuffer.allocate(tailleFichier);
            for (int i = 1; i &lt;= nombreEntiers; i&#43;&#43;) {
                buffer.putInt(i * 10); // Écriture des entiers 10, 20, ..., 100
            }
            buffer.flip();
            canal.write(buffer);
            System.out.println(&#34;Fichier créé avec succès : &#34; &#43; chemin.toAbsolutePath());
        } catch (IOException e) {
            System.err.println(&#34;Erreur lors de la création du fichier : &#34; &#43; e.getMessage());
            return;
        }

        // Étape 2 : Mappage en mémoire et manipulation
        try (FileChannel canal = FileChannel.open(chemin, StandardOpenOption.READ, StandardOpenOption.WRITE)) {
            // Mappage du fichier en mémoire
            MappedByteBuffer mappedBuffer = canal.map(FileChannel.MapMode.READ_WRITE, 0, tailleFichier);
            System.out.println(&#34;\nLecture des valeurs mappées :&#34;);
            
            // Lecture des 10 entiers
            for (int i = 0; i &lt; nombreEntiers; i&#43;&#43;) {
                int valeur = mappedBuffer.getInt();
                System.out.println(&#34;Position &#34; &#43; i &#43; &#34; : &#34; &#43; valeur);
            }
            
            // Modification de deux valeurs
            mappedBuffer.position(2 * 4); // Position pour le 3e entier (offset 8)
            mappedBuffer.putInt(999); // Remplace la valeur à la position 2
            mappedBuffer.position(5 * 4); // Position pour le 6e entier (offset 20)
            mappedBuffer.putInt(888); // Remplace la valeur à la position 5
            
            System.out.println(&#34;\nAprès modification des positions 2 et 5 :&#34;);
            mappedBuffer.position(0); // Retour au début pour relire
            for (int i = 0; i &lt; nombreEntiers; i&#43;&#43;) {
                int valeur = mappedBuffer.getInt();
                System.out.println(&#34;Position &#34; &#43; i &#43; &#34; : &#34; &#43; valeur);
            }
        } catch (IOException e) {
            System.err.println(&#34;Erreur lors du mappage ou de la manipulation : &#34; &#43; e.getMessage());
        }
    }
}
</textarea></div></div><button type=submit class="export-btn java-runner-1752020650615939461-btn" style="background:#1976d2;color:#fff;border:none;border-radius:4px;padding:8px 16px;font-size:1em;cursor:pointer;margin-top:8px">Exécuter</button></form><div class=export-result></div><div class=java-error-tooltip style="display:none;position:absolute;z-index:1000;background:#fff0f0;color:#c00;border:1px solid #c00;padding:6px 12px;border-radius:6px;font-size:1em;box-shadow:0 2px 8px #0002"></div><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/clike/clike.min.js></script><script>(function(){var t,n,s,o,e=document.getElementById("java-runner-1752020650615939461");if(!e)return;s=e.querySelector("form"),t=e.querySelector(".export-result"),o=s.querySelector(".export-endpoint-var").value,n=e.querySelector(".java-error-tooltip"),e.querySelectorAll(".export-file-block").forEach(function(e){var t,n,s=e.querySelector(".export-file-name").textContent,o=e.querySelector("textarea");s.endsWith(".java")&&(n=CodeMirror.fromTextArea(o,{mode:"text/x-java",theme:"eclipse",lineNumbers:!0,indentUnit:4,tabSize:4}),e._cm=n,e._javaErrorLines={},n.on("cursorActivity",function(){var s,o,t=e.querySelector(".java-error-status-bar");if(!t)return;s=n.getCursor(),o=e._javaErrorLines&&e._javaErrorLines[s.line],o?(t.textContent="Ligne "+(s.line+1)+" : "+o,t.style.visibility="visible"):(t.textContent="",t.style.visibility="hidden")})),s.endsWith(".java")&&(e.querySelector(".java-error-status-bar")||(t=document.createElement("div"),t.className="java-error-status-bar",t.style.marginTop="4px",t.style.fontSize="0.95em",t.style.color="#c00",t.style.minHeight="1.2em",t.style.visibility="hidden",e.appendChild(t)))});function i(e,t,s){n.textContent=e,n.style.display="block",n.style.left=t+10+"px",n.style.top=s+10+"px"}function a(){n.style.display="none"}s.onsubmit=function(n){n.preventDefault();var s,i,a,r,c=[],l=[];e.querySelectorAll(".export-file-block").forEach(function(e){var t=e.querySelector(".export-file-name").textContent,s=e.querySelector("textarea"),n=e._cm?e._cm.getValue():s.value;t.endsWith(".java")?c.push({name:t,content:n}):l.push({name:t,content:n})}),s=0,t.textContent="Exécution en cours",i=setInterval(function(){s=(s+1)%4,t.textContent="Exécution en cours"+".".repeat(s)},500),a=new AbortController,r=setTimeout(function(){a.abort()},3e4),fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({java_files:c,txt_files:l}),signal:a.signal}).then(function(e){if(clearInterval(i),clearTimeout(r),!e.ok&&e.status!==400)throw new Error("Erreur HTTP "+e.status+" : "+e.statusText);return e.text()}).then(function(n){try{if(s=JSON.parse(n),s.status==="ran_successfully"?t.innerHTML='<pre style="color:#222;background:#e0ffe0;padding:12px;border-radius:6px;">'+(s.output||"").replace(/\n/g,"<br>")+"</pre>":s.status==="compiling"?t.innerHTML='<pre style="color:#c00;background:#ffe0e0;padding:12px;border-radius:6px;">'+(s.error||"").replace(/\n/g,"<br>")+"</pre>":s.status==="runtime_error"?t.innerHTML='<pre style="color:#c00;background:#ffe0e0;padding:12px;border-radius:6px;">'+(s.error||"").replace(/\n/g,"<br>")+"</pre>":t.textContent=n,s.status==="compiling"){for(c=s.error||"",l=new RegExp(`([\\w./\\-]+\\.java):(\\d+): error: ([^\\n]+)([\\s\\S]*?)(?=\\n[\\w./\\-]+\\.java:|$)`,"g"),e.querySelectorAll(".export-file-block").forEach(function(e){e._cm&&e._cm.operation(function(){for(var n=e._cm.getAllMarks(),t=0;t<n.length;t++)n[t].clear()}),e._javaErrorLines={};var t=e.querySelector(".java-error-status-bar");t&&(t.textContent="",t.style.visibility="hidden")});(o=l.exec(c))!==null;){var s,o,c,l,a=o[1],u=o[2],h=o[3],d=o[4],i=parseInt(u,10)-1,r=(h+(d?d.replace(/\s+/g," "):"")).trim();e.querySelectorAll(".export-file-block").forEach(function(e){var t=e.querySelector(".export-file-name");t&&(t.textContent.trim()===a||t.textContent.trim().endsWith("/"+a)||t.textContent.trim().endsWith("\\"+a))&&(e._cm&&e._cm.operation(function(){e._cm.markText({line:i,ch:0},{line:i+1,ch:0},{className:"cm-java-error",title:r})}),e._javaErrorLines||(e._javaErrorLines={}),e._javaErrorLines[i]=r)})}e.querySelectorAll(".export-file-block").forEach(function(e){if(e._cm&&e._cm.getOption("lineNumbers")){var n,s,t=e.querySelector(".java-error-status-bar");t&&(n=e._cm.getCursor(),s=e._javaErrorLines&&e._javaErrorLines[n.line],s?(t.textContent="Ligne "+(n.line+1)+" : "+s,t.style.visibility="visible"):(t.textContent="",t.style.visibility="hidden"))}})}else e.querySelectorAll(".export-file-block").forEach(function(e){e._cm&&e._cm.operation(function(){for(var n=e._cm.getAllMarks(),t=0;t<n.length;t++)n[t].clear()}),e._javaErrorLines={};var t=e.querySelector(".java-error-status-bar");t&&(t.textContent="",t.style.visibility="hidden")})}catch(e){console.log(e),t.textContent=n}}).catch(function(e){clearInterval(i),clearTimeout(r),e.name==="AbortError"?t.textContent="Erreur : délai d’attente dépassé (30 secondes).":t.textContent="Erreur lors de la requête : "+e})},e.querySelectorAll(".export-file-block").forEach(function(e){var t=e._cm;if(!t)return;t.on("mouseover",function(t,n){var a,o=t.coordsChar({left:n.clientX,top:n.clientY}),s=o.line,c=o.ch,r=t.getCursor();s===r.line&&e._javaErrorLines&&e._javaErrorLines[s]&&(a=e._javaErrorLines[s],i(a,n.clientX,n.clientY))}),t.on("mouseout",function(){a()})})})()</script></div></div><p>MappedByteBuffer est conçu pour mapper un fichier directement en mémoire. Ses principales méthodes incluent get() et put() pour lire et écrire des données (octets, entiers, etc.) à la position actuelle du buffer, avec des variantes comme getInt() ou putInt() pour des types spécifiques. La méthode position(int) définit l’index courant pour les opérations, tandis que limit() et capacity() contrôlent la portée des données accessibles. La méthode flip() bascule le buffer du mode écriture au mode lecture, ajustant la limite à la position actuelle et réinitialisant la position à 0. force() synchronise les modifications avec le fichier sur disque, garantissant la persistance des changements. Enfin, load() charge le contenu mappé en mémoire physique pour optimiser les performances, et isLoaded() vérifie si le mappage est résident.</p><h3 id=conseils-génériques>Conseils génériques
<a class=anchor href=#conseils-g%c3%a9n%c3%a9riques>#</a></h3><p>Il faut privilégier les lectures/écritures en bloc (bufferisées). Il faut limiter les accès réseau (en réduire le nombre).</p><p>En contrepartie, il vaut mieux éviter de charger de très gros fichiers en une seule fois si ce n’est pas nécessaire (privilégier le traitement ligne par ligne ou par bloc). Votre ordinateur
est plus rapide s&rsquo;il ne traite que de petites quantités de données à la fois (ex. 10 Ko plutôt que 10 Mo).</p><h3 id=lecture-optionnelle-dans-le-livre-de-référence-delannoy>Lecture optionnelle dans le livre de référence (Delannoy)
<a class=anchor href=#lecture-optionnelle-dans-le-livre-de-r%c3%a9f%c3%a9rence-delannoy>#</a></h3><p>Pour aller plus en profondeur sur les flux de fichier (optionnel), vous pouvez lire dans <em>Programmer en Java</em> de Claude Delannoy, Chapitre 20:</p><ul><li>Section 1 : Fichier binaire</li><li>Section 2 : Liste séquentielle d'un fichier binaire</li><li>Section 3 : Accès direct à un fichier binaire</li><li>Section 6 : La gestion des fichiers avec la classe File</li></ul><h2 id=vidéo>Vidéo
<a class=anchor href=#vid%c3%a9o>#</a></h2><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share; fullscreen" loading=eager referrerpolicy=strict-origin-when-cross-origin src="https://www.youtube.com/embed/7hZVRDxpbCE?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 title="YouTube video"></iframe></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><div class="flex flex-wrap justify-between"><a href=/inf1220-hugo/docs/modules/module4/activite-4-1/ class="flex align-center float-left book-icon"><img src=/inf1220-hugo/svg/backward.svg alt=Previous title="Les flux de console">
<span>Les flux de console</span>
</a><a href=/inf1220-hugo/docs/modules/module4/exercices-4-1/ class="flex align-center float-right book-icon"><span>Exercices sur les flux</span>
<img src=/inf1220-hugo/svg/forward.svg alt=Next title="Exercices sur les flux"></a></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#la-classe-file>La classe File</a></li><li><a href=#lecture-dun-fichier>Lecture d&rsquo;un fichier</a></li><li><a href=#écriture-dun-fichier-texte>Écriture d&rsquo;un fichier texte</a></li><li><a href=#stringwriter-et-stringreader>StringWriter et StringReader</a></li><li><a href=#données-binaries-en-mémoire>Données binaries en mémoire</a></li><li><a href=#path-et-files>Path et Files</a></li><li><a href=#fichiers-properties>Fichiers <em>properties</em></a></li><li><a href=#utf-8>UTF-8</a></li><li><a href=#boutisme>Boutisme</a></li><li><a href=#accès-à-linternet>Accès à l&rsquo;Internet</a></li><li><a href=#performance>Performance</a><ul><li><a href=#données-binaires-et-performance>Données binaires et performance</a></li><li><a href=#conseils-génériques>Conseils génériques</a></li><li><a href=#lecture-optionnelle-dans-le-livre-de-référence-delannoy>Lecture optionnelle dans le livre de référence (Delannoy)</a></li></ul></li><li><a href=#vidéo>Vidéo</a></li></ul></nav></div></aside></main></body></html>